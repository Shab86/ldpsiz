\hypertarget{fileindex_8h}{\subsection{fileindex.\-h \-File \-Reference}
\label{fileindex_8h}\index{fileindex.\-h@{fileindex.\-h}}
}


\-Header for \hyperlink{fileindex_8c}{fileindex.\-c} \begin{DoxyCopyright}{\-Copyright}
\-Copyright (c) 2014, \-Alan \-R. \-Rogers $<$\href{mailto:rogers@anthro.utah.edu}{\tt rogers@anthro.\-utah.\-edu}$>$. \-This file is released under the \-Internet \-Systems \-Consortium \-License, which can be found in file \char`\"{}\-L\-I\-C\-E\-N\-S\-E\char`\"{}. 
\end{DoxyCopyright}
 


{\ttfamily \#include $<$stdio.\-h$>$}\*
{\ttfamily \#include \char`\"{}typedefs.\-h\char`\"{}}\*
\subsubsection*{\-Data \-Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_thread_bounds}{\-Thread\-Bounds}
\begin{DoxyCompactList}\small\item\em \-Each \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} object contains the information needed by an individual thread to figure out where in the input file to begin reading \-S\-N\-Ps and which \hyperlink{struct_s_n_p}{\-S\-N\-P} is its first focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{fileindex_8h_ac5bd54fb7553f1f1cd42985588721935}{\hyperlink{struct_file_index}{\-File\-Index} $\ast$ \hyperlink{fileindex_8h_ac5bd54fb7553f1f1cd42985588721935}{\-File\-Index\-\_\-new} (void)}\label{fileindex_8h_ac5bd54fb7553f1f1cd42985588721935}

\begin{DoxyCompactList}\small\item\em \-Construct an empty \hyperlink{struct_file_index}{\-File\-Index}. \end{DoxyCompactList}\item 
\hypertarget{fileindex_8h_a28efb742daa33ad1f0948fde462536fb}{void \hyperlink{fileindex_8h_a28efb742daa33ad1f0948fde462536fb}{\-File\-Index\-\_\-free} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx)}\label{fileindex_8h_a28efb742daa33ad1f0948fde462536fb}

\begin{DoxyCompactList}\small\item\em \-Free a \hyperlink{struct_file_index}{\-File\-Index} object. \end{DoxyCompactList}\item 
long \hyperlink{fileindex_8h_a374366d62baca351bf6f99e33529a404}{\-File\-Index\-\_\-push} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx, long seekpos, double mappos)
\begin{DoxyCompactList}\small\item\em \-Record location data for a \hyperlink{struct_s_n_p}{\-S\-N\-P} in the \hyperlink{struct_file_index}{\-File\-Index}. \end{DoxyCompactList}\item 
\hyperlink{struct_s_n_p_loc}{\-S\-N\-P\-Loc} $\ast$ \hyperlink{fileindex_8h_a65c624581e8aa4b657467ae806ea9edd}{\-File\-Index\-\_\-at\-Ndx} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx, long ndx)
\begin{DoxyCompactList}\small\item\em \-Return the \hyperlink{struct_s_n_p_loc}{\-S\-N\-P\-Loc} object for \hyperlink{struct_s_n_p}{\-S\-N\-P} with given index. \end{DoxyCompactList}\item 
\hypertarget{fileindex_8h_afde42da364b32e6f5308582435ea4677}{long \hyperlink{fileindex_8h_afde42da364b32e6f5308582435ea4677}{\-File\-Index\-\_\-at\-Map\-Pos} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx, double mappos)}\label{fileindex_8h_afde42da364b32e6f5308582435ea4677}

\begin{DoxyCompactList}\small\item\em \-Return index of smallest element in sorted array that is $>$= mappos. \end{DoxyCompactList}\item 
long \hyperlink{fileindex_8h_abde51934f56b0cc272af423b93ebecc1}{\-File\-Index\-\_\-n\-S\-N\-Ps} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx)
\begin{DoxyCompactList}\small\item\em \-Return the number of \-S\-N\-Ps. \end{DoxyCompactList}\item 
\hypertarget{fileindex_8h_a4b408243bc058394a5e8e041c16677f8}{void {\bfseries \-File\-Index\-\_\-print\-Summary} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx, \-F\-I\-L\-E $\ast$ofp)}\label{fileindex_8h_a4b408243bc058394a5e8e041c16677f8}

\item 
\hypertarget{fileindex_8h_a095eca2c81246cfe367db7aa15d24bbd}{void {\bfseries \-File\-Index\-\_\-print\-Chunks} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx, \-F\-I\-L\-E $\ast$ofp)}\label{fileindex_8h_a095eca2c81246cfe367db7aa15d24bbd}

\item 
\hypertarget{fileindex_8h_a04ac717025f3113bf063221042b77bdb}{void {\bfseries \-File\-Index\-\_\-print} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx, \-F\-I\-L\-E $\ast$ofp)}\label{fileindex_8h_a04ac717025f3113bf063221042b77bdb}

\item 
\hyperlink{struct_file_index}{\-File\-Index} $\ast$ \hyperlink{fileindex_8h_a201c707d3b56e87a80a5f8f563c79e77}{\-File\-Index\-\_\-read\-File} (\-F\-I\-L\-E $\ast$ifp)
\begin{DoxyCompactList}\small\item\em \-Read through a file, storing the location of each \hyperlink{struct_s_n_p}{\-S\-N\-P} in a structure of type \hyperlink{struct_file_index}{\-File\-Index}, which is then returned. \end{DoxyCompactList}\item 
void \hyperlink{fileindex_8h_ab3a3ace9a8babd53c842e9025c60d90b}{\-File\-Index\-\_\-realloc} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx, long ptrs\-Needed)
\begin{DoxyCompactList}\small\item\em \-Reallocate the list of pointers so that the number of them is at least as large as ptrs\-Needed. \end{DoxyCompactList}\item 
double \hyperlink{fileindex_8h_a91a955eddb088ddd3036a650f784c26c}{\-File\-Index\-\_\-get\-Map\-Pos} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx, long ndx)
\begin{DoxyCompactList}\small\item\em \-Return the map position (in c\-M) of \hyperlink{struct_s_n_p}{\-S\-N\-P} with given index. \end{DoxyCompactList}\item 
long \hyperlink{fileindex_8h_ad56891d9920d86df6d7253122bffac57}{\-File\-Index\-\_\-get\-Seek\-Pos} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx, long ndx)
\begin{DoxyCompactList}\small\item\em \-Return the seek position of \hyperlink{struct_s_n_p}{\-S\-N\-P} with given index. \end{DoxyCompactList}\item 
\hypertarget{fileindex_8h_a02d3c4ca98cebbdf370fe272e020854c}{void {\bfseries \-File\-Index\-\_\-sanity\-Check} (\hyperlink{struct_file_index}{\-File\-Index} $\ast$fi, const char $\ast$file, int lineno)}\label{fileindex_8h_a02d3c4ca98cebbdf370fe272e020854c}

\item 
\hypertarget{fileindex_8h_a846ebf1d9cb4684e7a44897db17733f8}{unsigned {\bfseries \-File\-Index\-\_\-n\-Ptrs} (void)}\label{fileindex_8h_a846ebf1d9cb4684e7a44897db17733f8}

\item 
\hypertarget{fileindex_8h_a20eccf0f6a3965656231f88d00f336cc}{unsigned {\bfseries \-File\-Index\-\_\-chunk\-Size} (void)}\label{fileindex_8h_a20eccf0f6a3965656231f88d00f336cc}

\item 
\hypertarget{fileindex_8h_a259d64385fde61a546b12de64409f35c}{long {\bfseries \-File\-Index\-\_\-n\-Ptrs\-Allocated} (const \hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx)}\label{fileindex_8h_a259d64385fde61a546b12de64409f35c}

\item 
\hypertarget{fileindex_8h_ae0c65eef8ffeddb2b4f429183cbc060d}{long {\bfseries \-S\-N\-P\-Loc\-\_\-seekpos} (const \hyperlink{struct_s_n_p_loc}{\-S\-N\-P\-Loc} $\ast$sl)}\label{fileindex_8h_ae0c65eef8ffeddb2b4f429183cbc060d}

\item 
\hypertarget{fileindex_8h_a2274eaf8c8dd1a005ab84ef2f08ad1fa}{double {\bfseries \-S\-N\-P\-Loc\-\_\-mappos} (const \hyperlink{struct_s_n_p_loc}{\-S\-N\-P\-Loc} $\ast$sl)}\label{fileindex_8h_a2274eaf8c8dd1a005ab84ef2f08ad1fa}

\item 
\hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$ \hyperlink{fileindex_8h_a1b4d131983c6556b42dae4a6feb2520a}{\-Thread\-Bounds\-\_\-new} (int nthreads, double windowcm, \hyperlink{struct_file_index}{\-File\-Index} $\ast$fndx)
\begin{DoxyCompactList}\small\item\em \-Divide the genome into contiguous chunks of roughly equal size, so that each chunk can be processed by a separate thread. \end{DoxyCompactList}\item 
\hypertarget{fileindex_8h_a184048af7d5ce6ba173a6f97eaba961b}{void {\bfseries \-Thread\-Bounds\-\_\-free} (\hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)}\label{fileindex_8h_a184048af7d5ce6ba173a6f97eaba961b}

\item 
\hypertarget{fileindex_8h_ac394fc1b9bbcc9d5603ca58b272ceb0f}{void {\bfseries \-Thread\-Bounds\-\_\-print} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb, int nthreads, \-F\-I\-L\-E $\ast$ofp)}\label{fileindex_8h_ac394fc1b9bbcc9d5603ca58b272ceb0f}

\item 
\hypertarget{fileindex_8h_af5361d34409132b8c221b0ab8e036cd8}{void {\bfseries \-Thread\-Bounds\-\_\-sanity\-Check} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb, const char $\ast$file, int lineno)}\label{fileindex_8h_af5361d34409132b8c221b0ab8e036cd8}

\item 
\hypertarget{fileindex_8h_aef9a0ee444663c8de7e23d0b13dcff24}{void {\bfseries \-Thread\-Bounds\-\_\-array\-Sanity\-Check} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb, int nthreads, const char $\ast$file, int lineno)}\label{fileindex_8h_aef9a0ee444663c8de7e23d0b13dcff24}

\item 
long \hyperlink{fileindex_8h_a483db940dea39738256e61c2531865e5}{\-Thread\-Bounds\-\_\-ndx\-\_\-initial} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)
\begin{DoxyCompactList}\small\item\em \-Return the index of the starting \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\item 
long \hyperlink{fileindex_8h_a90e7c0fa7545c99e16a9e84b528f8d37}{\-Thread\-Bounds\-\_\-ndx\-\_\-1st\-Focal} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)
\begin{DoxyCompactList}\small\item\em \-Return the index of the 1st focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\item 
long \hyperlink{fileindex_8h_a75f9d6173f21029e39d561014ee5932d}{\-Thread\-Bounds\-\_\-ndx\-\_\-last\-Focal} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)
\begin{DoxyCompactList}\small\item\em \-Return the index of the last focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\item 
long \hyperlink{fileindex_8h_a5e7f8b283c0bbdc8b64d7fb1956609ad}{\-Thread\-Bounds\-\_\-seekpos\-\_\-initial} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)
\begin{DoxyCompactList}\small\item\em \-Return the seek position of the starting \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\item 
long \hyperlink{fileindex_8h_a73db6fd24019c41e623793d24bf37eb8}{\-Thread\-Bounds\-\_\-seekpos\-\_\-1st\-Focal} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)
\begin{DoxyCompactList}\small\item\em \-Return the seek position of the 1st focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\item 
long \hyperlink{fileindex_8h_a7dabd51a48a5ae9e4797f033716f10ed}{\-Thread\-Bounds\-\_\-seekpos\-\_\-last\-Focal} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)
\begin{DoxyCompactList}\small\item\em \-Return the seek position of the last focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\item 
double \hyperlink{fileindex_8h_a549e164e58b7835b6ee140342e09ba83}{\-Thread\-Bounds\-\_\-mappos\-\_\-initial} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)
\begin{DoxyCompactList}\small\item\em \-Return the map position of the starting \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\item 
double \hyperlink{fileindex_8h_a2b982299e43282f51f14aa9ac9b9fea7}{\-Thread\-Bounds\-\_\-mappos\-\_\-1st\-Focal} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)
\begin{DoxyCompactList}\small\item\em \-Return the map position of the 1st focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\item 
double \hyperlink{fileindex_8h_a5a8e167cbca3fabb00d565923e07a3ae}{\-Thread\-Bounds\-\_\-mappos\-\_\-last\-Focal} (const \hyperlink{struct_thread_bounds}{\-Thread\-Bounds} $\ast$tb)
\begin{DoxyCompactList}\small\item\em \-Return the map position of the last focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-Header for \hyperlink{fileindex_8c}{fileindex.\-c} \begin{DoxyCopyright}{\-Copyright}
\-Copyright (c) 2014, \-Alan \-R. \-Rogers $<$\href{mailto:rogers@anthro.utah.edu}{\tt rogers@anthro.\-utah.\-edu}$>$. \-This file is released under the \-Internet \-Systems \-Consortium \-License, which can be found in file \char`\"{}\-L\-I\-C\-E\-N\-S\-E\char`\"{}. 
\end{DoxyCopyright}
\begin{DoxyAuthor}{\-Author}
\-Alan \-R. \-Rogers 
\end{DoxyAuthor}


\subsubsection{\-Function \-Documentation}
\hypertarget{fileindex_8h_a65c624581e8aa4b657467ae806ea9edd}{\index{fileindex.\-h@{fileindex.\-h}!\-File\-Index\-\_\-at\-Ndx@{\-File\-Index\-\_\-at\-Ndx}}
\index{\-File\-Index\-\_\-at\-Ndx@{\-File\-Index\-\_\-at\-Ndx}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-File\-Index\-\_\-at\-Ndx}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-S\-N\-P\-Loc}$\ast$ {\bf \-File\-Index\-\_\-at\-Ndx} (
\begin{DoxyParamCaption}
\item[{{\bf \-File\-Index} $\ast$}]{fndx, }
\item[{long}]{ndx}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a65c624581e8aa4b657467ae806ea9edd}


\-Return the \hyperlink{struct_s_n_p_loc}{\-S\-N\-P\-Loc} object for \hyperlink{struct_s_n_p}{\-S\-N\-P} with given index. 



\-Referenced by \-File\-Index\-\_\-at\-Map\-Pos(), \-File\-Index\-\_\-get\-Map\-Pos(), and \-File\-Index\-\_\-get\-Seek\-Pos().

\hypertarget{fileindex_8h_a91a955eddb088ddd3036a650f784c26c}{\index{fileindex.\-h@{fileindex.\-h}!\-File\-Index\-\_\-get\-Map\-Pos@{\-File\-Index\-\_\-get\-Map\-Pos}}
\index{\-File\-Index\-\_\-get\-Map\-Pos@{\-File\-Index\-\_\-get\-Map\-Pos}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-File\-Index\-\_\-get\-Map\-Pos}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf \-File\-Index\-\_\-get\-Map\-Pos} (
\begin{DoxyParamCaption}
\item[{{\bf \-File\-Index} $\ast$}]{fndx, }
\item[{long}]{ndx}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a91a955eddb088ddd3036a650f784c26c}


\-Return the map position (in c\-M) of \hyperlink{struct_s_n_p}{\-S\-N\-P} with given index. 



\-References \-File\-Index\-\_\-at\-Ndx().



\-Referenced by \-Thread\-Bounds\-\_\-new().

\hypertarget{fileindex_8h_ad56891d9920d86df6d7253122bffac57}{\index{fileindex.\-h@{fileindex.\-h}!\-File\-Index\-\_\-get\-Seek\-Pos@{\-File\-Index\-\_\-get\-Seek\-Pos}}
\index{\-File\-Index\-\_\-get\-Seek\-Pos@{\-File\-Index\-\_\-get\-Seek\-Pos}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-File\-Index\-\_\-get\-Seek\-Pos}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-File\-Index\-\_\-get\-Seek\-Pos} (
\begin{DoxyParamCaption}
\item[{{\bf \-File\-Index} $\ast$}]{fndx, }
\item[{long}]{ndx}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_ad56891d9920d86df6d7253122bffac57}


\-Return the seek position of \hyperlink{struct_s_n_p}{\-S\-N\-P} with given index. 



\-References \-File\-Index\-\_\-at\-Ndx().



\-Referenced by \-Thread\-Bounds\-\_\-new().

\hypertarget{fileindex_8h_abde51934f56b0cc272af423b93ebecc1}{\index{fileindex.\-h@{fileindex.\-h}!\-File\-Index\-\_\-n\-S\-N\-Ps@{\-File\-Index\-\_\-n\-S\-N\-Ps}}
\index{\-File\-Index\-\_\-n\-S\-N\-Ps@{\-File\-Index\-\_\-n\-S\-N\-Ps}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-File\-Index\-\_\-n\-S\-N\-Ps}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-File\-Index\-\_\-n\-S\-N\-Ps} (
\begin{DoxyParamCaption}
\item[{{\bf \-File\-Index} $\ast$}]{fndx}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_abde51934f56b0cc272af423b93ebecc1}


\-Return the number of \-S\-N\-Ps. 



\-Referenced by \-File\-Index\-\_\-at\-Map\-Pos(), and \-Thread\-Bounds\-\_\-new().

\hypertarget{fileindex_8h_a374366d62baca351bf6f99e33529a404}{\index{fileindex.\-h@{fileindex.\-h}!\-File\-Index\-\_\-push@{\-File\-Index\-\_\-push}}
\index{\-File\-Index\-\_\-push@{\-File\-Index\-\_\-push}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-File\-Index\-\_\-push}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-File\-Index\-\_\-push} (
\begin{DoxyParamCaption}
\item[{{\bf \-File\-Index} $\ast$}]{fndx, }
\item[{long}]{seekpos, }
\item[{double}]{mappos}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a374366d62baca351bf6f99e33529a404}


\-Record location data for a \hyperlink{struct_s_n_p}{\-S\-N\-P} in the \hyperlink{struct_file_index}{\-File\-Index}. 


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em fndx} & points to \hyperlink{struct_file_index}{\-File\-Index}. \\
\hline
\mbox{\tt in}  & {\em seekpos} & seek position of new entry \\
\hline
\mbox{\tt in}  & {\em mappos} & map position (in c\-M) of new entry \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
index of newly recorded \hyperlink{struct_s_n_p}{\-S\-N\-P}. 
\end{DoxyReturn}


\-References \-File\-Index\-\_\-realloc().



\-Referenced by \-File\-Index\-\_\-read\-File().

\hypertarget{fileindex_8h_a201c707d3b56e87a80a5f8f563c79e77}{\index{fileindex.\-h@{fileindex.\-h}!\-File\-Index\-\_\-read\-File@{\-File\-Index\-\_\-read\-File}}
\index{\-File\-Index\-\_\-read\-File@{\-File\-Index\-\_\-read\-File}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-File\-Index\-\_\-read\-File}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-File\-Index}$\ast$ {\bf \-File\-Index\-\_\-read\-File} (
\begin{DoxyParamCaption}
\item[{\-F\-I\-L\-E $\ast$}]{ifp}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a201c707d3b56e87a80a5f8f563c79e77}


\-Read through a file, storing the location of each \hyperlink{struct_s_n_p}{\-S\-N\-P} in a structure of type \hyperlink{struct_file_index}{\-File\-Index}, which is then returned. 


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em ifp} & \-Pointer to input stream. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{\-Returns}
\-N\-U\-L\-L if \-F\-I\-L\-E pointer is \-N\-U\-L\-L. \-If no sites are found, it returns an empty \hyperlink{struct_file_index}{\-File\-Index}. \-Otherwise, function returns a pointer to an object of type \hyperlink{struct_file_index}{\-File\-Index}. 
\end{DoxyReturn}


\-References \-Assignment\-\_\-free(), \-Assignment\-\_\-set\-Int(), \-Dbl\-\_\-near(), \-File\-Index\-\_\-new(), \-File\-Index\-\_\-push(), \-Gtp\-\_\-read\-Hdr(), and \-Gtp\-\_\-read\-S\-N\-P().

\hypertarget{fileindex_8h_ab3a3ace9a8babd53c842e9025c60d90b}{\index{fileindex.\-h@{fileindex.\-h}!\-File\-Index\-\_\-realloc@{\-File\-Index\-\_\-realloc}}
\index{\-File\-Index\-\_\-realloc@{\-File\-Index\-\_\-realloc}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-File\-Index\-\_\-realloc}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-File\-Index\-\_\-realloc} (
\begin{DoxyParamCaption}
\item[{{\bf \-File\-Index} $\ast$}]{fndx, }
\item[{long}]{ptrs\-Needed}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_ab3a3ace9a8babd53c842e9025c60d90b}


\-Reallocate the list of pointers so that the number of them is at least as large as ptrs\-Needed. 

\-All newly-\/allocated pointers are set equal to \-N\-U\-L\-L. 

\-Referenced by \-File\-Index\-\_\-push().

\hypertarget{fileindex_8h_a2b982299e43282f51f14aa9ac9b9fea7}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-mappos\-\_\-1st\-Focal@{\-Thread\-Bounds\-\_\-mappos\-\_\-1st\-Focal}}
\index{\-Thread\-Bounds\-\_\-mappos\-\_\-1st\-Focal@{\-Thread\-Bounds\-\_\-mappos\-\_\-1st\-Focal}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-mappos\-\_\-1st\-Focal}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf \-Thread\-Bounds\-\_\-mappos\-\_\-1st\-Focal} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Thread\-Bounds} $\ast$}]{tb}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a2b982299e43282f51f14aa9ac9b9fea7}


\-Return the map position of the 1st focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. 

\hypertarget{fileindex_8h_a549e164e58b7835b6ee140342e09ba83}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-mappos\-\_\-initial@{\-Thread\-Bounds\-\_\-mappos\-\_\-initial}}
\index{\-Thread\-Bounds\-\_\-mappos\-\_\-initial@{\-Thread\-Bounds\-\_\-mappos\-\_\-initial}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-mappos\-\_\-initial}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf \-Thread\-Bounds\-\_\-mappos\-\_\-initial} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Thread\-Bounds} $\ast$}]{tb}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a549e164e58b7835b6ee140342e09ba83}


\-Return the map position of the starting \hyperlink{struct_s_n_p}{\-S\-N\-P}. 

\hypertarget{fileindex_8h_a5a8e167cbca3fabb00d565923e07a3ae}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-mappos\-\_\-last\-Focal@{\-Thread\-Bounds\-\_\-mappos\-\_\-last\-Focal}}
\index{\-Thread\-Bounds\-\_\-mappos\-\_\-last\-Focal@{\-Thread\-Bounds\-\_\-mappos\-\_\-last\-Focal}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-mappos\-\_\-last\-Focal}]{\setlength{\rightskip}{0pt plus 5cm}double {\bf \-Thread\-Bounds\-\_\-mappos\-\_\-last\-Focal} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Thread\-Bounds} $\ast$}]{tb}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a5a8e167cbca3fabb00d565923e07a3ae}


\-Return the map position of the last focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. 

\hypertarget{fileindex_8h_a90e7c0fa7545c99e16a9e84b528f8d37}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-ndx\-\_\-1st\-Focal@{\-Thread\-Bounds\-\_\-ndx\-\_\-1st\-Focal}}
\index{\-Thread\-Bounds\-\_\-ndx\-\_\-1st\-Focal@{\-Thread\-Bounds\-\_\-ndx\-\_\-1st\-Focal}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-ndx\-\_\-1st\-Focal}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-Thread\-Bounds\-\_\-ndx\-\_\-1st\-Focal} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Thread\-Bounds} $\ast$}]{tb}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a90e7c0fa7545c99e16a9e84b528f8d37}


\-Return the index of the 1st focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. 



\-Referenced by threadfun().

\hypertarget{fileindex_8h_a483db940dea39738256e61c2531865e5}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-ndx\-\_\-initial@{\-Thread\-Bounds\-\_\-ndx\-\_\-initial}}
\index{\-Thread\-Bounds\-\_\-ndx\-\_\-initial@{\-Thread\-Bounds\-\_\-ndx\-\_\-initial}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-ndx\-\_\-initial}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-Thread\-Bounds\-\_\-ndx\-\_\-initial} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Thread\-Bounds} $\ast$}]{tb}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a483db940dea39738256e61c2531865e5}


\-Return the index of the starting \hyperlink{struct_s_n_p}{\-S\-N\-P}. 



\-Referenced by threadfun().

\hypertarget{fileindex_8h_a75f9d6173f21029e39d561014ee5932d}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-ndx\-\_\-last\-Focal@{\-Thread\-Bounds\-\_\-ndx\-\_\-last\-Focal}}
\index{\-Thread\-Bounds\-\_\-ndx\-\_\-last\-Focal@{\-Thread\-Bounds\-\_\-ndx\-\_\-last\-Focal}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-ndx\-\_\-last\-Focal}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-Thread\-Bounds\-\_\-ndx\-\_\-last\-Focal} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Thread\-Bounds} $\ast$}]{tb}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a75f9d6173f21029e39d561014ee5932d}


\-Return the index of the last focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. 



\-Referenced by threadfun().

\hypertarget{fileindex_8h_a1b4d131983c6556b42dae4a6feb2520a}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-new@{\-Thread\-Bounds\-\_\-new}}
\index{\-Thread\-Bounds\-\_\-new@{\-Thread\-Bounds\-\_\-new}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-new}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Thread\-Bounds}$\ast$ {\bf \-Thread\-Bounds\-\_\-new} (
\begin{DoxyParamCaption}
\item[{int}]{nthreads, }
\item[{double}]{windowcm, }
\item[{{\bf \-File\-Index} $\ast$}]{fndx}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a1b4d131983c6556b42dae4a6feb2520a}


\-Divide the genome into contiguous chunks of roughly equal size, so that each chunk can be processed by a separate thread. 

\-On input, nthreads gives the number of threads, windowsize (the number of \-S\-N\-Ps in the sliding window), and ifp points to the input file stream. \-The function returns a pointer to a newly-\/allocated array of type \hyperlink{struct_thread_bounds}{\-Thread\-Bounds}, which has an entry for each thread, each of which is an object of type \hyperlink{struct_thread_bounds}{\-Thread\-Bounds}. \-The i'th entry defines the starting position for thread i. 

\-References \-File\-Index\-\_\-at\-Map\-Pos(), \-File\-Index\-\_\-get\-Map\-Pos(), \-File\-Index\-\_\-get\-Seek\-Pos(), and \-File\-Index\-\_\-n\-S\-N\-Ps().

\hypertarget{fileindex_8h_a73db6fd24019c41e623793d24bf37eb8}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-seekpos\-\_\-1st\-Focal@{\-Thread\-Bounds\-\_\-seekpos\-\_\-1st\-Focal}}
\index{\-Thread\-Bounds\-\_\-seekpos\-\_\-1st\-Focal@{\-Thread\-Bounds\-\_\-seekpos\-\_\-1st\-Focal}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-seekpos\-\_\-1st\-Focal}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-Thread\-Bounds\-\_\-seekpos\-\_\-1st\-Focal} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Thread\-Bounds} $\ast$}]{tb}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a73db6fd24019c41e623793d24bf37eb8}


\-Return the seek position of the 1st focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. 

\hypertarget{fileindex_8h_a5e7f8b283c0bbdc8b64d7fb1956609ad}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-seekpos\-\_\-initial@{\-Thread\-Bounds\-\_\-seekpos\-\_\-initial}}
\index{\-Thread\-Bounds\-\_\-seekpos\-\_\-initial@{\-Thread\-Bounds\-\_\-seekpos\-\_\-initial}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-seekpos\-\_\-initial}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-Thread\-Bounds\-\_\-seekpos\-\_\-initial} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Thread\-Bounds} $\ast$}]{tb}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a5e7f8b283c0bbdc8b64d7fb1956609ad}


\-Return the seek position of the starting \hyperlink{struct_s_n_p}{\-S\-N\-P}. 



\-Referenced by threadfun().

\hypertarget{fileindex_8h_a7dabd51a48a5ae9e4797f033716f10ed}{\index{fileindex.\-h@{fileindex.\-h}!\-Thread\-Bounds\-\_\-seekpos\-\_\-last\-Focal@{\-Thread\-Bounds\-\_\-seekpos\-\_\-last\-Focal}}
\index{\-Thread\-Bounds\-\_\-seekpos\-\_\-last\-Focal@{\-Thread\-Bounds\-\_\-seekpos\-\_\-last\-Focal}!fileindex.h@{fileindex.\-h}}
\paragraph[{\-Thread\-Bounds\-\_\-seekpos\-\_\-last\-Focal}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-Thread\-Bounds\-\_\-seekpos\-\_\-last\-Focal} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Thread\-Bounds} $\ast$}]{tb}
\end{DoxyParamCaption}
)}}\label{fileindex_8h_a7dabd51a48a5ae9e4797f033716f10ed}


\-Return the seek position of the last focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. 

