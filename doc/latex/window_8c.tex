\hypertarget{window_8c}{\subsection{window.\-c \-File \-Reference}
\label{window_8c}\index{window.\-c@{window.\-c}}
}


\-A window that slides across the chromosome.  


{\ttfamily \#include \char`\"{}window.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}readgtp.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}misc.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}tabulation.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}spectab.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}boot.\-h\char`\"{}}\*
{\ttfamily \#include \char`\"{}sums.\-h\char`\"{}}\*
{\ttfamily \#include $<$stdio.\-h$>$}\*
{\ttfamily \#include $<$stdbool.\-h$>$}\*
{\ttfamily \#include $<$stdlib.\-h$>$}\*
{\ttfamily \#include $<$string.\-h$>$}\*
{\ttfamily \#include $<$assert.\-h$>$}\*
{\ttfamily \#include $<$math.\-h$>$}\*
{\ttfamily \#include $<$float.\-h$>$}\*
{\ttfamily \#include $<$pthread.\-h$>$}\*
{\ttfamily \#include \char`\"{}assign.\-h\char`\"{}}\*
\subsubsection*{\-Data \-Structures}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{struct_window}{\-Window}
\begin{DoxyCompactList}\small\item\em \hyperlink{struct_window}{\-Window} represents a window that slides across the chromosome. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{struct_window}{\-Window} $\ast$ \hyperlink{window_8c_a32650574dc7bdc08308978788f364db2}{\-Window\-\_\-new} (double width\-\_\-cm, \-F\-I\-L\-E $\ast$ifp, long int sampling\-\_\-interval, unsigned ploidy)
\begin{DoxyCompactList}\small\item\em \-Allocate a new \hyperlink{struct_window}{\-Window}. \end{DoxyCompactList}\item 
\hypertarget{window_8c_a02c4ebe92c5d6690a47037bb3ee0f170}{void \hyperlink{window_8c_a02c4ebe92c5d6690a47037bb3ee0f170}{\-Window\-\_\-free} (\hyperlink{struct_window}{\-Window} $\ast$window)}\label{window_8c_a02c4ebe92c5d6690a47037bb3ee0f170}

\begin{DoxyCompactList}\small\item\em \-Free a \hyperlink{struct_window}{\-Window}. \end{DoxyCompactList}\item 
\hypertarget{window_8c_a44ea0be885fc164f1b724fefa225a75e}{\hyperlink{struct_s_n_p}{\-S\-N\-P} $\ast$ \hyperlink{window_8c_a44ea0be885fc164f1b724fefa225a75e}{\-Window\-\_\-curr\-S\-N\-P} (\hyperlink{struct_window}{\-Window} $\ast$window)}\label{window_8c_a44ea0be885fc164f1b724fefa225a75e}

\begin{DoxyCompactList}\small\item\em \-Return pointer to current focal \hyperlink{struct_s_n_p}{\-S\-N\-P}. \end{DoxyCompactList}\item 
int \hyperlink{window_8c_abc05c7153486e330e6c043a19dccc814}{\-Window\-\_\-next\-S\-N\-P} (\hyperlink{struct_window}{\-Window} $\ast$window, \hyperlink{struct_boot}{\-Boot} $\ast$boot)
\begin{DoxyCompactList}\small\item\em \-Get next \hyperlink{struct_s_n_p}{\-S\-N\-P} from input file and link it into the linked list pointed to by window-\/$>$curr. \end{DoxyCompactList}\item 
int \hyperlink{window_8c_a3c1635732568184a46f4419bbaa75ea3}{\-Window\-\_\-advance} (\hyperlink{struct_window}{\-Window} $\ast$window, \hyperlink{struct_tabulation}{\-Tabulation} $\ast$tab, \hyperlink{struct_spectab}{\-Spectab} $\ast$spectab, \hyperlink{struct_boot}{\-Boot} $\ast$boot, long lineno)
\begin{DoxyCompactList}\small\item\em \-Add a new \hyperlink{struct_s_n_p}{\-S\-N\-P} to the window. \end{DoxyCompactList}\item 
unsigned \hyperlink{window_8c_a73541ede96e20d3a09c7165f975372e7}{\-Window\-\_\-n\-Gtype} (const \hyperlink{struct_window}{\-Window} $\ast$window)
\begin{DoxyCompactList}\small\item\em \-Return window-\/$>$n\-Gtype. \end{DoxyCompactList}\item 
\hypertarget{window_8c_a730c7dc3096f9c1aaeedfaa39b11d591}{unsigned \hyperlink{window_8c_a730c7dc3096f9c1aaeedfaa39b11d591}{\-Window\-\_\-ploidy} (const \hyperlink{struct_window}{\-Window} $\ast$window)}\label{window_8c_a730c7dc3096f9c1aaeedfaa39b11d591}

\begin{DoxyCompactList}\small\item\em \-Return window-\/$>$ploidy. \end{DoxyCompactList}\item 
long \hyperlink{window_8c_a67b5392fe87dc00fe45c4fa17d166cb4}{\-Window\-\_\-n\-S\-N\-Ps\-Read} (const \hyperlink{struct_window}{\-Window} $\ast$window)
\begin{DoxyCompactList}\small\item\em \-Return the number of \-S\-N\-Ps that have been read. \end{DoxyCompactList}\item 
\hypertarget{window_8c_a4369fd29ec7984e8e3f1ecb5614ec278}{void {\bfseries \-Window\-\_\-test} (int verbose)}\label{window_8c_a4369fd29ec7984e8e3f1ecb5614ec278}

\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\-A window that slides across the chromosome. \begin{DoxyAuthor}{\-Author}
\-Alan \-R. \-Rogers \-L\-D is calculated from pairs of sites within a window, which slides across the chromosome. \-This file implements \hyperlink{struct_window}{\-Window}, which represents that sliding window.
\end{DoxyAuthor}
\begin{DoxyCopyright}{\-Copyright}
\-Copyright (c) 2014, \-Alan \-R. \-Rogers $<$\href{mailto:rogers@anthro.utah.edu}{\tt rogers@anthro.\-utah.\-edu}$>$. \-This file is released under the \-Internet \-Systems \-Consortium \-License, which can be found in file \char`\"{}\-L\-I\-C\-E\-N\-S\-E\char`\"{}. 
\end{DoxyCopyright}


\subsubsection{\-Function \-Documentation}
\hypertarget{window_8c_a3c1635732568184a46f4419bbaa75ea3}{\index{window.\-c@{window.\-c}!\-Window\-\_\-advance@{\-Window\-\_\-advance}}
\index{\-Window\-\_\-advance@{\-Window\-\_\-advance}!window.c@{window.\-c}}
\paragraph[{\-Window\-\_\-advance}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf \-Window\-\_\-advance} (
\begin{DoxyParamCaption}
\item[{{\bf \-Window} $\ast$}]{window, }
\item[{{\bf \-Tabulation} $\ast$}]{tab, }
\item[{{\bf \-Spectab} $\ast$}]{spectab, }
\item[{{\bf \-Boot} $\ast$}]{boot, }
\item[{long}]{lineno}
\end{DoxyParamCaption}
)}}\label{window_8c_a3c1635732568184a46f4419bbaa75ea3}


\-Add a new \hyperlink{struct_s_n_p}{\-S\-N\-P} to the window. 

\-Estimate the linkage disequilibrium (\-L\-D) between single nucleotide polymorphisms (\-S\-N\-Ps) as a function of the map distance between those \-S\-N\-Ps. 

\-References \-Boot\-\_\-add\-Allele\-Count(), \-Window\-::curr, \-Dbl\-\_\-near(), \-Window\-::ploidy, \-Window\-::sampling\-\_\-interval, \-S\-N\-P\-\_\-count\-Minor(), \-S\-N\-P\-\_\-get\-Dsq(), \-S\-N\-Pstore\-\_\-checkin(), \-Window\-::store, \-Window\-::width\-\_\-cm, and \-Window\-\_\-next\-S\-N\-P().

\hypertarget{window_8c_a32650574dc7bdc08308978788f364db2}{\index{window.\-c@{window.\-c}!\-Window\-\_\-new@{\-Window\-\_\-new}}
\index{\-Window\-\_\-new@{\-Window\-\_\-new}!window.c@{window.\-c}}
\paragraph[{\-Window\-\_\-new}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Window}$\ast$ {\bf \-Window\-\_\-new} (
\begin{DoxyParamCaption}
\item[{double}]{width\-\_\-cm, }
\item[{\-F\-I\-L\-E $\ast$}]{ifp, }
\item[{long int}]{sampling\-\_\-interval, }
\item[{unsigned}]{ploidy}
\end{DoxyParamCaption}
)}}\label{window_8c_a32650574dc7bdc08308978788f364db2}


\-Allocate a new \hyperlink{struct_window}{\-Window}. 


\begin{DoxyParams}[1]{\-Parameters}
\mbox{\tt in}  & {\em width\-\_\-cm} & width of \hyperlink{struct_window}{\-Window} in centimorgans\\
\hline
\mbox{\tt in}  & {\em sampling\-\_\-interval} & \-If sampling\-\_\-interval is 2, window will skip every other \hyperlink{struct_s_n_p}{\-S\-N\-P}. \-This makes things fast for debugging.\\
\hline
\mbox{\tt in}  & {\em ploidy} & 1 for haploid, 2 for diploid \\
\hline
\end{DoxyParams}


\-References \-Window\-::curr, \-Window\-::ifp, \-Window\-::n\-Gtype, \-Window\-::n\-S\-N\-Ps, \-Window\-::ploidy, \-Window\-::sampling\-\_\-interval, \-Window\-::store, and \-Window\-::width\-\_\-cm.

\hypertarget{window_8c_abc05c7153486e330e6c043a19dccc814}{\index{window.\-c@{window.\-c}!\-Window\-\_\-next\-S\-N\-P@{\-Window\-\_\-next\-S\-N\-P}}
\index{\-Window\-\_\-next\-S\-N\-P@{\-Window\-\_\-next\-S\-N\-P}!window.c@{window.\-c}}
\paragraph[{\-Window\-\_\-next\-S\-N\-P}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf \-Window\-\_\-next\-S\-N\-P} (
\begin{DoxyParamCaption}
\item[{{\bf \-Window} $\ast$}]{window, }
\item[{{\bf \-Boot} $\ast$}]{boot}
\end{DoxyParamCaption}
)}}\label{window_8c_abc05c7153486e330e6c043a19dccc814}


\-Get next \hyperlink{struct_s_n_p}{\-S\-N\-P} from input file and link it into the linked list pointed to by window-\/$>$curr. 

\-Return 0 on success, \-E\-O\-F if end of file is reached, and 1 on any other error. 

\-References \-Window\-::curr, \-Dbl\-\_\-near(), \-Gtp\-\_\-read\-S\-N\-P(), \-Window\-::gtype, \-Window\-::ifp, \-Window\-::n\-Gtype, \-Window\-::n\-S\-N\-Ps, \-Window\-::ploidy, \-S\-N\-P\-\_\-set(), \-S\-N\-P\-\_\-show(), \-S\-N\-Pstore\-\_\-checkout(), \-S\-N\-Pstore\-\_\-new(), and \-Window\-::store.

\hypertarget{window_8c_a73541ede96e20d3a09c7165f975372e7}{\index{window.\-c@{window.\-c}!\-Window\-\_\-n\-Gtype@{\-Window\-\_\-n\-Gtype}}
\index{\-Window\-\_\-n\-Gtype@{\-Window\-\_\-n\-Gtype}!window.c@{window.\-c}}
\paragraph[{\-Window\-\_\-n\-Gtype}]{\setlength{\rightskip}{0pt plus 5cm}unsigned {\bf \-Window\-\_\-n\-Gtype} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Window} $\ast$}]{window}
\end{DoxyParamCaption}
)}}\label{window_8c_a73541ede96e20d3a09c7165f975372e7}


\-Return window-\/$>$n\-Gtype. 

\-Return current value of window-\/$>$n\-Gtype. 

\-References \-Window\-::n\-Gtype.

\hypertarget{window_8c_a67b5392fe87dc00fe45c4fa17d166cb4}{\index{window.\-c@{window.\-c}!\-Window\-\_\-n\-S\-N\-Ps\-Read@{\-Window\-\_\-n\-S\-N\-Ps\-Read}}
\index{\-Window\-\_\-n\-S\-N\-Ps\-Read@{\-Window\-\_\-n\-S\-N\-Ps\-Read}!window.c@{window.\-c}}
\paragraph[{\-Window\-\_\-n\-S\-N\-Ps\-Read}]{\setlength{\rightskip}{0pt plus 5cm}long {\bf \-Window\-\_\-n\-S\-N\-Ps\-Read} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Window} $\ast$}]{window}
\end{DoxyParamCaption}
)}}\label{window_8c_a67b5392fe87dc00fe45c4fa17d166cb4}


\-Return the number of \-S\-N\-Ps that have been read. 



\-References \-Window\-::n\-S\-N\-Ps.

