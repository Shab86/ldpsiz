<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ldpsiz: em.h File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ldpsiz
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">LDPSIZ is a system of programs written in C and Python, which uses linkage disequilibrium to estimate parameters describing the history of population size.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">em.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header for <a class="el" href="em_8c.html" title="Estimate D from partially phased diploid data using the EM algorithm. Copyright (c) 2014...">em.c</a>. </p>
<dl class="copyright"><dt><b>Copyright:</b></dt><dd>Copyright (c) 2014, Alan R. Rogers &lt;<a href="mailto:rogers@anthro.utah.edu">rogers@anthro.utah.edu</a>&gt;. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
 
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="typedefs_8h_source.html">typedefs.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="window_8h_source.html">window.h</a>&quot;</code><br/>
</div>
<p><a href="em_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_dsq_data.html">DsqData</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Data used by EM algorithm in estimating Dsq from partially phased diploid data.  <a href="struct_dsq_data.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93b7cf745acae7e2576794d4c249b54a"></a><!-- doxytag: member="em.h::HOMOZYGOTE" ref="a93b7cf745acae7e2576794d4c249b54a" args="(A)" -->
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8h.html#a93b7cf745acae7e2576794d4c249b54a">HOMOZYGOTE</a>(A)&#160;&#160;&#160;((A)==0 || (A)==3)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Is A a homozygote? <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8h.html#af87ac73700dde449611bc66b21933e05">UNPHASED_PAIR</a>(A, B)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">True if A and B are both heterozygotes and at least one is unphased.  <a href="#af87ac73700dde449611bc66b21933e05"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8h.html#aa2ec8b4ffcd44be3d58ca9ab1515e61c">MAKE_PHASED</a>(A)&#160;&#160;&#160;((A)==UNPHASED_HETEROZYGOTE ? 1 : (A))</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">If A is an unphased heterozygote, then convert it to a phased one (genotype 1).  <a href="#aa2ec8b4ffcd44be3d58ca9ab1515e61c"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac7a72db338562cbc0b59de2fdd7ea383"></a><!-- doxytag: member="em.h::DsqData_print" ref="ac7a72db338562cbc0b59de2fdd7ea383" args="(DsqData *dd, const char *file, int line, FILE *fp)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8h.html#ac7a72db338562cbc0b59de2fdd7ea383">DsqData_print</a> (<a class="el" href="struct_dsq_data.html">DsqData</a> *dd, const char *file, int line, FILE *fp)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Print an object of type <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data.">DsqData</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8h.html#a70f8344502c41e439800cf30e69c3217">DsqData_reset</a> (<a class="el" href="struct_dsq_data.html">DsqData</a> *dd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Make <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data.">DsqData</a> object consistent with its current allele freqs.  <a href="#a70f8344502c41e439800cf30e69c3217"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a08218d02cbbe98122c481c1db576efee"></a><!-- doxytag: member="em.h::loD" ref="a08218d02cbbe98122c481c1db576efee" args="(double pA, double pB, unsigned *nGam)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8h.html#a08218d02cbbe98122c481c1db576efee">loD</a> (double pA, double pB, unsigned *nGam)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Lowest feasible value of D, given allele frequencies. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9519759fd7d57cd97eab1c8ac0126a9f"></a><!-- doxytag: member="em.h::hiD" ref="a9519759fd7d57cd97eab1c8ac0126a9f" args="(double pA, double pB, unsigned *nGam)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8h.html#a9519759fd7d57cd97eab1c8ac0126a9f">hiD</a> (double pA, double pB, unsigned *nGam)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Highest feasible value of D, given allele frequencies. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8h.html#a87c044fe7efd7a666e878823e35eeae2">minimize1D</a> (double *D, <a class="el" href="struct_dsq_data.html">DsqData</a> *dd)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This algorithm finds the minimum of function negLnL within the range [a,b], where a = dd-&gt;loD, and b=dd-&gt;hiD.  <a href="#a87c044fe7efd7a666e878823e35eeae2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8h.html#ad62d2aed5f4185224b6a4115f01f5322">trBits</a> (unsigned char *x, unsigned char *y)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Think of x and y as the two rows of a matrix, with the columns of the matrix equal to the bits of x and y.  <a href="#ad62d2aed5f4185224b6a4115f01f5322"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9f4e32e6073a95ad0248d522fa65aed1"></a><!-- doxytag: member="em.h::gamete" ref="a9f4e32e6073a95ad0248d522fa65aed1" args="(unsigned char x, unsigned char y)" -->
static unsigned char&#160;</td><td class="memItemRight" valign="bottom"><b>gamete</b> (unsigned char x, unsigned char y)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Header for <a class="el" href="em_8c.html" title="Estimate D from partially phased diploid data using the EM algorithm. Copyright (c) 2014...">em.c</a>. </p>
<dl class="copyright"><dt><b>Copyright:</b></dt><dd>Copyright (c) 2014, Alan R. Rogers &lt;<a href="mailto:rogers@anthro.utah.edu">rogers@anthro.utah.edu</a>&gt;. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
<dl class="author"><dt><b>Author:</b></dt><dd>Alan R. Rogers </dd></dl>
</div><hr/><h2>Define Documentation</h2>
<a class="anchor" id="aa2ec8b4ffcd44be3d58ca9ab1515e61c"></a><!-- doxytag: member="em.h::MAKE_PHASED" ref="aa2ec8b4ffcd44be3d58ca9ab1515e61c" args="(A)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="em_8h.html#aa2ec8b4ffcd44be3d58ca9ab1515e61c">MAKE_PHASED</a></td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">A</td><td>)</td>
          <td>&#160;&#160;&#160;((A)==UNPHASED_HETEROZYGOTE ? 1 : (A))</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>If A is an unphased heterozygote, then convert it to a phased one (genotype 1). </p>
<p>Otherwise leave it alone. </p>

<p>Referenced by <a class="el" href="window_8h.html#a87ee2fddc8bce33e477b74326fc67eb1">SNP_getDsq()</a>.</p>

</div>
</div>
<a class="anchor" id="af87ac73700dde449611bc66b21933e05"></a><!-- doxytag: member="em.h::UNPHASED_PAIR" ref="af87ac73700dde449611bc66b21933e05" args="(A, B)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="em_8h.html#af87ac73700dde449611bc66b21933e05">UNPHASED_PAIR</a></td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">A, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">B&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment">(((A)==UNPHASED_HETEROZYGOTE &amp;&amp; !<a class="code" href="em_8h.html#a93b7cf745acae7e2576794d4c249b54a" title="Is A a homozygote?">HOMOZYGOTE</a>(B)) \
                            || ((B)==UNPHASED_HETEROZYGOTE &amp;&amp; !<a class="code" href="em_8h.html#a93b7cf745acae7e2576794d4c249b54a" title="Is A a homozygote?">HOMOZYGOTE</a>(A)))
</pre></div>
<p>True if A and B are both heterozygotes and at least one is unphased. </p>

<p>Referenced by <a class="el" href="window_8h.html#a87ee2fddc8bce33e477b74326fc67eb1">SNP_getDsq()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a70f8344502c41e439800cf30e69c3217"></a><!-- doxytag: member="em.h::DsqData_reset" ref="a70f8344502c41e439800cf30e69c3217" args="(DsqData *dd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="em_8h.html#a70f8344502c41e439800cf30e69c3217">DsqData_reset</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dsq_data.html">DsqData</a> *&#160;</td>
          <td class="paramname"><em>dd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data.">DsqData</a> object consistent with its current allele freqs. </p>

<p>References <a class="el" href="struct_dsq_data.html#a40c3fdd276e9c89802f1173601460afc">DsqData::alpha</a>, <a class="el" href="struct_dsq_data.html#a9104819f67f85886818033b08e56cd5d">DsqData::beta</a>, <a class="el" href="struct_dsq_data.html#abfab53744a39ef6d7bdebc293344d7a9">DsqData::hiD</a>, <a class="el" href="em_8c.html#a9519759fd7d57cd97eab1c8ac0126a9f">hiD()</a>, <a class="el" href="struct_dsq_data.html#aa1b3a9ab84e0b900689f4f87939f93b5">DsqData::loD</a>, <a class="el" href="em_8c.html#a08218d02cbbe98122c481c1db576efee">loD()</a>, <a class="el" href="struct_dsq_data.html#adcf855e9e80223d33131cb0e2b44c53e">DsqData::nGam</a>, <a class="el" href="struct_dsq_data.html#a8bae4af34213c754abcef73f595e3e4a">DsqData::px</a>, and <a class="el" href="struct_dsq_data.html#aa3f221eac7bb1919a62b2f8b5489c3a4">DsqData::py</a>.</p>

</div>
</div>
<a class="anchor" id="a87c044fe7efd7a666e878823e35eeae2"></a><!-- doxytag: member="em.h::minimize1D" ref="a87c044fe7efd7a666e878823e35eeae2" args="(double *D, DsqData *dd)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="em_8h.html#a87c044fe7efd7a666e878823e35eeae2">minimize1D</a> </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dsq_data.html">DsqData</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This algorithm finds the minimum of function negLnL within the range [a,b], where a = dd-&gt;loD, and b=dd-&gt;hiD. </p>
<p>The algorithm uses Newton steps when these go downhill, and otherwise bisects in the downhill direction.</p>
<p>When Newton fails, the next step is in the downhill direction, as indicated by the derivative. If the derivative at the boundary has the same sign as that at the current point, the algorithm bets that the function is monotonic and takes a big step. Otherwise, there must be an intermediate minimum, so the algorithm bisects.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">D</td><td>Lewontin's original measure of linkage disequilibrium,</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dd</td><td>pointer to object of type <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data.">DsqData</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the integer 0 </dd></dl>

<p>References <a class="el" href="struct_dsq_data.html#abfab53744a39ef6d7bdebc293344d7a9">DsqData::hiD</a>, <a class="el" href="em_8c.html#ac6b55dd3fa20189828cd95479cf123b6">initialD()</a>, <a class="el" href="struct_dsq_data.html#aa1b3a9ab84e0b900689f4f87939f93b5">DsqData::loD</a>, <a class="el" href="em_8c.html#ac62cd04463d127258ef6e76bb67294ce">negLnL_df()</a>, <a class="el" href="em_8c.html#aff767b1a15cee1790a925391115f111f">negLnL_df12()</a>, and <a class="el" href="struct_dsq_data.html#a2817fb4b70921ae3a9722c1fbf0f4a58">DsqData::tol</a>.</p>

<p>Referenced by <a class="el" href="window_8h.html#a87ee2fddc8bce33e477b74326fc67eb1">SNP_getDsq()</a>.</p>

</div>
</div>
<a class="anchor" id="ad62d2aed5f4185224b6a4115f01f5322"></a><!-- doxytag: member="em.h::trBits" ref="ad62d2aed5f4185224b6a4115f01f5322" args="(unsigned char *x, unsigned char *y)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void <a class="el" href="em_8h.html#ad62d2aed5f4185224b6a4115f01f5322">trBits</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>y</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Think of x and y as the two rows of a matrix, with the columns of the matrix equal to the bits of x and y. </p>
<p>We are only interested in the low-order (rightmost) pair of bits. Transpose that 2X2 matrix, so that x and y are set equal to the bits that had previously been in the columns.</p>
<p>In other words, if [i,j] are the right-most two bits of x, and [k,l] are the right-most two bits of y, then the function does the following transformation:</p>
<p>x: i j x: i k ----&gt; y: k l y: j l</p>
<p>Suppose, for example, that x=2, or in binary, x=0b10. Furthermore, suppose that y=3=0b11. Then after a call to trBits, we'll have x=3=0b11 and y=1=0b01.</p>
<p>Any higher-order bits are ignored. For example, the preceding example still generates x=3 and y=1, even if on input y=7=0b111. </p>

<p>Referenced by <a class="el" href="window_8h.html#a87ee2fddc8bce33e477b74326fc67eb1">SNP_getDsq()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Wed May 28 2014 13:46:40 for ldpsiz by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
