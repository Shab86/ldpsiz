<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>ldpsiz: readgtp.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ldpsiz
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">LDPSIZ is a system of programs written in C and Python, which uses linkage disequilibrium to estimate parameters describing the history of population size.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">readgtp.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Parse files written in .gtp format, which are used as input by eld.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;ctype.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;pthread.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;limits.h&gt;</code><br />
<code>#include &quot;<a class="el" href="tokenizer_8h_source.html">tokenizer.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="misc_8h_source.html">misc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fileindex_8h_source.html">fileindex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="assign_8h_source.html">assign.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="readgtp_8h_source.html">readgtp.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af381f767322c8addbf5366317792126e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="struct_assignment.html">Assignment</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="readgtp_8c.html#af381f767322c8addbf5366317792126e">Gtp_readHdr</a> (FILE *ifp)</td></tr>
<tr class="memdesc:af381f767322c8addbf5366317792126e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read header of file ifp in order to parse assignment statements.  <a href="#af381f767322c8addbf5366317792126e">More...</a><br /></td></tr>
<tr class="separator:af381f767322c8addbf5366317792126e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5000436dd66fa65fa9b7ebe9f3fe77c1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="readgtp_8c.html#a5000436dd66fa65fa9b7ebe9f3fe77c1">Gtp_readSNP</a> (FILE *ifp, char *snpId, size_t snpIdSize, double *mappos, char *alleles, size_t allelesSize, unsigned char *sitedat, size_t sitedatSize, int isDiploid)</td></tr>
<tr class="memdesc:a5000436dd66fa65fa9b7ebe9f3fe77c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a> from the GTP output file.  <a href="#a5000436dd66fa65fa9b7ebe9f3fe77c1">More...</a><br /></td></tr>
<tr class="separator:a5000436dd66fa65fa9b7ebe9f3fe77c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Parse files written in .gtp format, which are used as input by eld. </p>
<dl class="section author"><dt>Author</dt><dd>Alan R. Rogers </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2014, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span style="display: none;">.nosp@m.</span>s@an<span style="display: none;">.nosp@m.</span>thro.<span style="display: none;">.nosp@m.</span>utah<span style="display: none;">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="af381f767322c8addbf5366317792126e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="struct_assignment.html">Assignment</a>* Gtp_readHdr </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>ifp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read header of file ifp in order to parse assignment statements. </p>
<p>These assignments are stored an a structure of class <a class="el" href="struct_assignment.html" title="A linked list, each item representing the name and value of a variable whose value is assigned in an ...">Assignment</a>, which is returned to the calling function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ifp</td><td>Points to input file stream. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to <a class="el" href="struct_assignment.html" title="A linked list, each item representing the name and value of a variable whose value is assigned in an ...">Assignment</a> structure. </dd></dl>
<dl class="section user"><dt>Side Effects:</dt><dd>The file pointer ifp is positioned so that the next line read will be the first <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a>. </dd></dl>

<p>References <a class="el" href="assign_8c.html#a166adfe0311bc2721c473d5a8306a7b5">Assignment_new()</a>.</p>

<p>Referenced by <a class="el" href="fileindex_8h.html#a201c707d3b56e87a80a5f8f563c79e77">FileIndex_readFile()</a>.</p>

</div>
</div>
<a class="anchor" id="a5000436dd66fa65fa9b7ebe9f3fe77c1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Gtp_readSNP </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname"><em>ifp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>snpId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>snpIdSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>mappos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>alleles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>allelesSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>sitedat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>sitedatSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>isDiploid</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a> from the GTP output file. </p>
<p>Return 0 on success, 1 on failure.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ifp</td><td>Points to input file stream. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">snpId</td><td>Character buffer to hold the string that identifies current <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">snpIdSize</td><td>Size of snpId. If snpIdSize==0, nothing will be written into snpId. In this case, it is OK to pass NULL for the value of snpId. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mappos</td><td>Map position of current <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a> in centimorgans. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">alleles</td><td>This string will contain a list of the alleles present at current <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">allelesSize</td><td>Size of "alleles". If allelesSize==0, nothing will be written into alleles. In this case, it is OK to pass NULL for the value of alleles. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sitedat</td><td>Unsigned character buffer whose i'th entry will hold the genotype data for the i'th individual. This value is an integer that encodes genotypic values as described in the documentation of function encodeGtype, defined in file <a class="el" href="misc_8h.html" title="Header for misc.c. ">misc.h</a>. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sitedatSize</td><td>Size of the sitedat array. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">isDiploid</td><td>The data are assumed to be diploid if isDiploid is nonzero. Otherwise, haploidy is assumed. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A positive number (the number of genotypes) on success, but a negative number (EOF) on end of file. </dd></dl>

<p>References <a class="el" href="misc_8h.html#a6145fd187aa0acb77724a751cb5f0c49">encodeDiploid()</a>, and <a class="el" href="misc_8h.html#a4cbb5fef7f691ec548c30f73b67ce2b0">encodeHaploid()</a>.</p>

<p>Referenced by <a class="el" href="fileindex_8h.html#a201c707d3b56e87a80a5f8f563c79e77">FileIndex_readFile()</a>, and <a class="el" href="window_8h.html#abc05c7153486e330e6c043a19dccc814">Window_nextSNP()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 29 2014 10:22:46 for ldpsiz by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
