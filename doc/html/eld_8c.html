<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>ldpsiz: eld.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ldpsiz
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">LDPSIZ is a system of programs written in C and Python, which uses linkage disequilibrium to estimate parameters describing the history of population size.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">eld.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Estimate LD from genetic data.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;getopt.h&gt;</code><br />
<code>#include &lt;limits.h&gt;</code><br />
<code>#include &lt;pthread.h&gt;</code><br />
<code>#include &lt;gsl/gsl_rng.h&gt;</code><br />
<code>#include &quot;<a class="el" href="typedefs_8h_source.html">typedefs.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="misc_8h_source.html">misc.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="readgtp_8h_source.html">readgtp.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fileindex_8h_source.html">fileindex.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="tabulation_8h_source.html">tabulation.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="window_8h_source.html">window.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="boot_8h_source.html">boot.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="assign_8h_source.html">assign.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ini_8h_source.html">ini.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_thread_arg.html">ThreadArg</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data required by a single thread.  <a href="struct_thread_arg.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad96d407a911fbb914fa8e4cfbf2faf0f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad96d407a911fbb914fa8e4cfbf2faf0f"></a>
static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="eld_8c.html#ad96d407a911fbb914fa8e4cfbf2faf0f">usage</a> (void)</td></tr>
<tr class="memdesc:ad96d407a911fbb914fa8e4cfbf2faf0f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print usage message and abort. <br /></td></tr>
<tr class="separator:ad96d407a911fbb914fa8e4cfbf2faf0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66191769f33182335e7077162760c2fa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a66191769f33182335e7077162760c2fa"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="eld_8c.html#a66191769f33182335e7077162760c2fa">ThreadArg_print</a> (<a class="el" href="struct_thread_arg.html">ThreadArg</a> *targ, FILE *ofp)</td></tr>
<tr class="memdesc:a66191769f33182335e7077162760c2fa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print <a class="el" href="struct_thread_arg.html" title="Data required by a single thread. ">ThreadArg</a> object. <br /></td></tr>
<tr class="separator:a66191769f33182335e7077162760c2fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914284d220ff633606a4a5913080266d"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="eld_8c.html#a914284d220ff633606a4a5913080266d">threadfun</a> (void *varg)</td></tr>
<tr class="memdesc:a914284d220ff633606a4a5913080266d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><code>eld</code> runs a copy of this function within each thread.  <a href="#a914284d220ff633606a4a5913080266d">More...</a><br /></td></tr>
<tr class="separator:a914284d220ff633606a4a5913080266d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>main</b> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Estimate LD from genetic data. </p>
<p><a class="anchor" id="eld"></a></p><h1><code>eld</code>, a program that estimates LD from genetic data </h1>
<p>Parameter values, including those describing population history, may be read either from the initialization file <code>ldpsiz.ini</code> or specified on the command line. Command-line arguments override values in the initialization file.</p>
<p><code>eld</code> reads data in "gtp" format and estimates two measures of LD: <img class="formulaInl" alt="$\hat\sigma_d^2$" src="form_0.png"/> and <img class="formulaInl" alt="$r^2$" src="form_1.png"/>. The program compares all pairs of sites within a window that slides across the data set. These pairs are tabulated into bins based on the distance (in cM) that separates them. For each bin, the program estimates and prints the two measures of LD. The maximal separation between pairs of SNPs is determined by the <code>--window</code> (or <code>-w</code>) option.</p>
<p>Optionally, the program calculates a moving-blocks bootstrap for <img class="formulaInl" alt="$\hat\sigma_d^2$" src="form_0.png"/>. To turn on this option, use the <code>--bootreps</code> option discussed below. The program will then print lower and upper confidence limits along with each estimate of <img class="formulaInl" alt="$\hat\sigma_d^2$" src="form_0.png"/>. By default, the bootstrap includes 95% of the sampling distribution distribution. This fraction can be modified using the initialization file. Optionally, the bootstrap may be stored in a separate file for use by other programs. To accomplish this, use the command-line option <code>--bootfile</code> or set <code>bootfile</code> in <code>ldpsiz.ini</code>.</p>
<p>By default, the program uses as many threads as there are cores on the machine. To change this, use the command-line option <code>--threads</code> or set <code>nthreads</code> in the file <code>ldpsiz.ini</code>. </p><pre class="fragment">usage: eld [options] input_file_name
   where options may include:
   -b \&lt;x\&gt; or --blocksize \&lt;x\&gt;
      SNPs per bootstrap block
   -f \&lt;x\&gt; or --bootfile \&lt;x\&gt;
      name of bootstrap output file
   -h or --help
      print this message
   -i \&lt;x\&gt; or --interval \&lt;x\&gt;
      for debugging: increase speed by examining every x'th focal SNP
   -n \&lt;x\&gt; or --nbins \&lt;x\&gt;
      tablulate values into x bins
   -r \&lt;x\&gt; or --bootreps \&lt;x\&gt;
      number of bootstrap replicates (def: 0)
   -t \&lt;x\&gt; or --threads \&lt;x\&gt;
      number of threads (default is auto)
   -v     or --verbose
      more output
   -w \&lt;x\&gt; or --window \&lt;x\&gt;
      window size in cM
</pre><dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2014, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span style="display: none;">.nosp@m.</span>s@an<span style="display: none;">.nosp@m.</span>thro.<span style="display: none;">.nosp@m.</span>utah<span style="display: none;">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a914284d220ff633606a4a5913080266d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * threadfun </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>vjq</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><code>eld</code> runs a copy of this function within each thread. </p>
<p>Waits until there is a job in the queue, pops it off and executes it, then waits for another.</p>
<p>The function opens the input file, which gives the thread its own input buffer so that it can move around in the file without locking it. Then it examines pairs of SNPs within a window that slides across the SNPs it is responsible for, placing the results into an object of type <a class="el" href="struct_tabulation.html">Tabulation</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">varg</td><td>A void pointer to an object of type <a class="el" href="struct_thread_arg.html" title="Data required by a single thread. ">ThreadArg</a>.</td></tr>
  </table>
  </dd>
</dl>
<p>Runs until jobs are completed and main thread sets acceptingJobs=0. </p>

<p>References <a class="el" href="struct_thread_arg.html#aab899376a7a5c492cec323d9e5728ac2">ThreadArg::boot</a>, <a class="el" href="struct_thread_arg.html#a7cde74c6b70efcf38d8fdeebe013caed">ThreadArg::ifname</a>, <a class="el" href="struct_thread_arg.html#a1545068c4f69181dc3430ef2c8602e00">ThreadArg::nGtype</a>, <a class="el" href="struct_thread_arg.html#a989aaeb84593c8dcb02f3b35e4274af8">ThreadArg::overflow</a>, <a class="el" href="struct_thread_arg.html#a61ef333440ed43a9b79d977714d2117d">ThreadArg::ploidy</a>, <a class="el" href="struct_thread_arg.html#ac82e3148f3f1efd2ad66f235afd1f5e5">ThreadArg::sampling_interval</a>, <a class="el" href="struct_thread_arg.html#a69ddbb101f4e7bb5e28c4b1f05f1e42c">ThreadArg::tab</a>, <a class="el" href="tabulation_8c.html#ae40028affe31e853583827d64a92b677">Tabulation_overflow()</a>, <a class="el" href="struct_thread_arg.html#ac4848e29e694d7a9c5b0b09896cc3f37">ThreadArg::tb</a>, <a class="el" href="fileindex_8c.html#a90e7c0fa7545c99e16a9e84b528f8d37">ThreadBounds_ndx_1stFocal()</a>, <a class="el" href="fileindex_8c.html#a483db940dea39738256e61c2531865e5">ThreadBounds_ndx_initial()</a>, <a class="el" href="fileindex_8c.html#a75f9d6173f21029e39d561014ee5932d">ThreadBounds_ndx_lastFocal()</a>, <a class="el" href="fileindex_8c.html#a5e7f8b283c0bbdc8b64d7fb1956609ad">ThreadBounds_seekpos_initial()</a>, <a class="el" href="window_8c.html#a10deeb4bf2f92ac26a87c6fac57325d4">Window_advance()</a>, <a class="el" href="struct_thread_arg.html#a7142e5de7bd8476071e81684ac1308d5">ThreadArg::window_cm</a>, <a class="el" href="window_8c.html#a02c4ebe92c5d6690a47037bb3ee0f170">Window_free()</a>, <a class="el" href="window_8c.html#a32650574dc7bdc08308978788f364db2">Window_new()</a>, <a class="el" href="window_8c.html#abc05c7153486e330e6c043a19dccc814">Window_nextSNP()</a>, and <a class="el" href="window_8c.html#a73541ede96e20d3a09c7165f975372e7">Window_nGtype()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 29 2014 10:22:46 for ldpsiz by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
