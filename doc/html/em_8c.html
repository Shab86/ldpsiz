<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>ldpsiz: em.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ldpsiz
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">LDPSIZ is a system of programs written in C and Python, which uses linkage disequilibrium to estimate parameters describing the history of population size.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">em.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Estimate D from partially phased diploid data using the EM algorithm.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;float.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &lt;gsl/gsl_errno.h&gt;</code><br />
<code>#include &lt;gsl/gsl_math.h&gt;</code><br />
<code>#include &lt;gsl/gsl_min.h&gt;</code><br />
<code>#include &quot;<a class="el" href="em_8h_source.html">em.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="misc_8h_source.html">misc.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a42aac61d69eca504560d930902cc22ef"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a42aac61d69eca504560d930902cc22ef"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>GO_RIGHT</b>(F, A, X, B)&#160;&#160;&#160;((X) + (F)*((B)-(X)))</td></tr>
<tr class="separator:a42aac61d69eca504560d930902cc22ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12ba8f06480b6cab4520a49677436fa4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a12ba8f06480b6cab4520a49677436fa4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>GO_LEFT</b>(F, A, X, B)&#160;&#160;&#160;((X) - (F)*((X)-(A)))</td></tr>
<tr class="separator:a12ba8f06480b6cab4520a49677436fa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aca8aadc79c96e7549ed3d87b9ab34a08"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aca8aadc79c96e7549ed3d87b9ab34a08"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#aca8aadc79c96e7549ed3d87b9ab34a08">negLnL</a> (double D, void *data)</td></tr>
<tr class="memdesc:aca8aadc79c96e7549ed3d87b9ab34a08"><td class="mdescLeft">&#160;</td><td class="mdescRight">Negative of log Likelihood of given value of D. <br /></td></tr>
<tr class="separator:aca8aadc79c96e7549ed3d87b9ab34a08"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac62cd04463d127258ef6e76bb67294ce"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#ac62cd04463d127258ef6e76bb67294ce">negLnL_df</a> (double D, void *data)</td></tr>
<tr class="memdesc:ac62cd04463d127258ef6e76bb67294ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Negative of log Likelihood of given value of D.  <a href="#ac62cd04463d127258ef6e76bb67294ce">More...</a><br /></td></tr>
<tr class="separator:ac62cd04463d127258ef6e76bb67294ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a763cb7889838068344aefd1eb170e94a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#a763cb7889838068344aefd1eb170e94a">negLnL_fdf</a> (double D, double *f, double *df, void *data)</td></tr>
<tr class="memdesc:a763cb7889838068344aefd1eb170e94a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Negative of log Likelihood of given value of D.  <a href="#a763cb7889838068344aefd1eb170e94a">More...</a><br /></td></tr>
<tr class="separator:a763cb7889838068344aefd1eb170e94a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29b4d31a97204bcb067c077c1b16dd3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#a29b4d31a97204bcb067c077c1b16dd3a">negLnL_fddf</a> (double D, double *f, double *df, double *ddf, void *data)</td></tr>
<tr class="memdesc:a29b4d31a97204bcb067c077c1b16dd3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Negative of log Likelihood of given value of D.  <a href="#a29b4d31a97204bcb067c077c1b16dd3a">More...</a><br /></td></tr>
<tr class="separator:a29b4d31a97204bcb067c077c1b16dd3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff767b1a15cee1790a925391115f111f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#aff767b1a15cee1790a925391115f111f">negLnL_df12</a> (double D, double *df, double *ddf, void *data)</td></tr>
<tr class="memdesc:aff767b1a15cee1790a925391115f111f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Negative of log Likelihood of given value of D.  <a href="#aff767b1a15cee1790a925391115f111f">More...</a><br /></td></tr>
<tr class="separator:aff767b1a15cee1790a925391115f111f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a638346b09068d817fcb23ebc995291a5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a638346b09068d817fcb23ebc995291a5"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#a638346b09068d817fcb23ebc995291a5">get_w</a> (double D, <a class="el" href="struct_dsq_data.html">DsqData</a> *dd)</td></tr>
<tr class="memdesc:a638346b09068d817fcb23ebc995291a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value of w implied by D, and the parameters in d. <br /></td></tr>
<tr class="separator:a638346b09068d817fcb23ebc995291a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff0275c84deb2d4b7de0f4748eec1256"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#aff0275c84deb2d4b7de0f4748eec1256">getD</a> (double w, <a class="el" href="struct_dsq_data.html">DsqData</a> *dd)</td></tr>
<tr class="memdesc:aff0275c84deb2d4b7de0f4748eec1256"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return value of D implied by given value of w.  <a href="#aff0275c84deb2d4b7de0f4748eec1256">More...</a><br /></td></tr>
<tr class="separator:aff0275c84deb2d4b7de0f4748eec1256"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb1dfc954ce3aba4150aba1ca6dbeedc"><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#adb1dfc954ce3aba4150aba1ca6dbeedc">next_w</a> (double w, <a class="el" href="struct_dsq_data.html">DsqData</a> *dd)</td></tr>
<tr class="memdesc:adb1dfc954ce3aba4150aba1ca6dbeedc"><td class="mdescLeft">&#160;</td><td class="mdescRight">One step of EM algorithm.  <a href="#adb1dfc954ce3aba4150aba1ca6dbeedc">More...</a><br /></td></tr>
<tr class="separator:adb1dfc954ce3aba4150aba1ca6dbeedc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3dc3d753ab71ff84227bd31d9f407915"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#a3dc3d753ab71ff84227bd31d9f407915">find_D</a> (double D0, <a class="el" href="struct_dsq_data.html">DsqData</a> *dd)</td></tr>
<tr class="memdesc:a3dc3d753ab71ff84227bd31d9f407915"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ad hoc iterations to find D.  <a href="#a3dc3d753ab71ff84227bd31d9f407915">More...</a><br /></td></tr>
<tr class="separator:a3dc3d753ab71ff84227bd31d9f407915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b55dd3fa20189828cd95479cf123b6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac6b55dd3fa20189828cd95479cf123b6"></a>
static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#ac6b55dd3fa20189828cd95479cf123b6">initialD</a> (<a class="el" href="struct_dsq_data.html">DsqData</a> *dd)</td></tr>
<tr class="memdesc:ac6b55dd3fa20189828cd95479cf123b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data. ">DsqData</a> object from current data, assuming that half of unphased heterozygotes have 2-locus genotype 11/00 and the other half have 10/01. <br /></td></tr>
<tr class="separator:ac6b55dd3fa20189828cd95479cf123b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7a72db338562cbc0b59de2fdd7ea383"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac7a72db338562cbc0b59de2fdd7ea383"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#ac7a72db338562cbc0b59de2fdd7ea383">DsqData_print</a> (<a class="el" href="struct_dsq_data.html">DsqData</a> *dd, const char *file, int line, FILE *fp)</td></tr>
<tr class="memdesc:ac7a72db338562cbc0b59de2fdd7ea383"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print an object of type <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data. ">DsqData</a>. <br /></td></tr>
<tr class="separator:ac7a72db338562cbc0b59de2fdd7ea383"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70f8344502c41e439800cf30e69c3217"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#a70f8344502c41e439800cf30e69c3217">DsqData_reset</a> (<a class="el" href="struct_dsq_data.html">DsqData</a> *dd)</td></tr>
<tr class="memdesc:a70f8344502c41e439800cf30e69c3217"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data. ">DsqData</a> object consistent with its current allele freqs.  <a href="#a70f8344502c41e439800cf30e69c3217">More...</a><br /></td></tr>
<tr class="separator:a70f8344502c41e439800cf30e69c3217"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08218d02cbbe98122c481c1db576efee"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a08218d02cbbe98122c481c1db576efee"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#a08218d02cbbe98122c481c1db576efee">loD</a> (double pA, double pB, unsigned *nGam)</td></tr>
<tr class="memdesc:a08218d02cbbe98122c481c1db576efee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Lowest feasible value of D, given allele frequencies. <br /></td></tr>
<tr class="separator:a08218d02cbbe98122c481c1db576efee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9519759fd7d57cd97eab1c8ac0126a9f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9519759fd7d57cd97eab1c8ac0126a9f"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#a9519759fd7d57cd97eab1c8ac0126a9f">hiD</a> (double pA, double pB, unsigned *nGam)</td></tr>
<tr class="memdesc:a9519759fd7d57cd97eab1c8ac0126a9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Highest feasible value of D, given allele frequencies. <br /></td></tr>
<tr class="separator:a9519759fd7d57cd97eab1c8ac0126a9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87c044fe7efd7a666e878823e35eeae2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="em_8c.html#a87c044fe7efd7a666e878823e35eeae2">minimize1D</a> (double *D, <a class="el" href="struct_dsq_data.html">DsqData</a> *dd)</td></tr>
<tr class="memdesc:a87c044fe7efd7a666e878823e35eeae2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This algorithm finds the minimum of function negLnL within the range [a,b], where a = dd-&gt;loD, and b=dd-&gt;hiD.  <a href="#a87c044fe7efd7a666e878823e35eeae2">More...</a><br /></td></tr>
<tr class="separator:a87c044fe7efd7a666e878823e35eeae2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Estimate D from partially phased diploid data using the EM algorithm. </p>
<dl class="section author"><dt>Author</dt><dd>Alan R. Rogers </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2014, Alan R. Rogers <a href="#" onclick="location.href='mai'+'lto:'+'rog'+'er'+'s@a'+'nt'+'hro'+'.u'+'tah'+'.e'+'du'; return false;">roger<span style="display: none;">.nosp@m.</span>s@an<span style="display: none;">.nosp@m.</span>thro.<span style="display: none;">.nosp@m.</span>utah<span style="display: none;">.nosp@m.</span>.edu</a>. This file is released under the Internet Systems Consortium License, which can be found in file "LICENSE". </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a70f8344502c41e439800cf30e69c3217"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DsqData_reset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_dsq_data.html">DsqData</a> *&#160;</td>
          <td class="paramname"><em>dd</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data. ">DsqData</a> object consistent with its current allele freqs. </p>

<p>References <a class="el" href="struct_dsq_data.html#a40c3fdd276e9c89802f1173601460afc">DsqData::alpha</a>, <a class="el" href="struct_dsq_data.html#a9104819f67f85886818033b08e56cd5d">DsqData::beta</a>, <a class="el" href="struct_dsq_data.html#abfab53744a39ef6d7bdebc293344d7a9">DsqData::hiD</a>, <a class="el" href="em_8c.html#a9519759fd7d57cd97eab1c8ac0126a9f">hiD()</a>, <a class="el" href="struct_dsq_data.html#aa1b3a9ab84e0b900689f4f87939f93b5">DsqData::loD</a>, <a class="el" href="em_8c.html#a08218d02cbbe98122c481c1db576efee">loD()</a>, <a class="el" href="struct_dsq_data.html#adcf855e9e80223d33131cb0e2b44c53e">DsqData::nGam</a>, <a class="el" href="struct_dsq_data.html#a8bae4af34213c754abcef73f595e3e4a">DsqData::px</a>, and <a class="el" href="struct_dsq_data.html#aa3f221eac7bb1919a62b2f8b5489c3a4">DsqData::py</a>.</p>

</div>
</div>
<a class="anchor" id="a3dc3d753ab71ff84227bd31d9f407915"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double find_D </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>D0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dsq_data.html">DsqData</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ad hoc iterations to find D. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">D0</td><td>Starting value for EM algorithm. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Points to a structure containing data. </td></tr>
  </table>
  </dd>
</dl>

<p>References <a class="el" href="em_8c.html#a638346b09068d817fcb23ebc995291a5">get_w()</a>, <a class="el" href="em_8c.html#aff0275c84deb2d4b7de0f4748eec1256">getD()</a>, and <a class="el" href="struct_dsq_data.html#a2817fb4b70921ae3a9722c1fbf0f4a58">DsqData::tol</a>.</p>

</div>
</div>
<a class="anchor" id="aff0275c84deb2d4b7de0f4748eec1256"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double getD </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dsq_data.html">DsqData</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Return value of D implied by given value of w. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Current guess as to fraction of unphased double-heterozygotes with two-locus genotype 11/00 rather than 10/01.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dd</td><td>pointer to object of type <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data. ">DsqData</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>improved estimate of w </dd></dl>

<p>References <a class="el" href="struct_dsq_data.html#adcf855e9e80223d33131cb0e2b44c53e">DsqData::nGam</a>, <a class="el" href="struct_dsq_data.html#ab6f188885c3a13ac49eee9ce9fd84445">DsqData::nGtype</a>, <a class="el" href="struct_dsq_data.html#a996906c461f0ce756ae25e72fd889be2">DsqData::nUnphased</a>, <a class="el" href="struct_dsq_data.html#a8bae4af34213c754abcef73f595e3e4a">DsqData::px</a>, and <a class="el" href="struct_dsq_data.html#aa3f221eac7bb1919a62b2f8b5489c3a4">DsqData::py</a>.</p>

<p>Referenced by <a class="el" href="em_8c.html#a3dc3d753ab71ff84227bd31d9f407915">find_D()</a>, and <a class="el" href="em_8c.html#adb1dfc954ce3aba4150aba1ca6dbeedc">next_w()</a>.</p>

</div>
</div>
<a class="anchor" id="a87c044fe7efd7a666e878823e35eeae2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int minimize1D </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dsq_data.html">DsqData</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This algorithm finds the minimum of function negLnL within the range [a,b], where a = dd-&gt;loD, and b=dd-&gt;hiD. </p>
<p>The algorithm uses Newton steps when these go downhill, and otherwise bisects in the downhill direction.</p>
<p>When Newton fails, the next step is in the downhill direction, as indicated by the derivative. If the derivative at the boundary has the same sign as that at the current point, the algorithm bets that the function is monotonic and takes a big step. Otherwise, there must be an intermediate minimum, so the algorithm bisects.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">D</td><td>Lewontin's original measure of linkage disequilibrium,</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dd</td><td>pointer to object of type <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data. ">DsqData</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the integer 0 </dd></dl>

<p>References <a class="el" href="struct_dsq_data.html#abfab53744a39ef6d7bdebc293344d7a9">DsqData::hiD</a>, <a class="el" href="em_8c.html#ac6b55dd3fa20189828cd95479cf123b6">initialD()</a>, <a class="el" href="struct_dsq_data.html#aa1b3a9ab84e0b900689f4f87939f93b5">DsqData::loD</a>, <a class="el" href="em_8c.html#ac62cd04463d127258ef6e76bb67294ce">negLnL_df()</a>, <a class="el" href="em_8c.html#aff767b1a15cee1790a925391115f111f">negLnL_df12()</a>, and <a class="el" href="struct_dsq_data.html#a2817fb4b70921ae3a9722c1fbf0f4a58">DsqData::tol</a>.</p>

<p>Referenced by <a class="el" href="window_8h.html#a87ee2fddc8bce33e477b74326fc67eb1">SNP_getDsq()</a>.</p>

</div>
</div>
<a class="anchor" id="ac62cd04463d127258ef6e76bb67294ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double negLnL_df </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Negative of log Likelihood of given value of D. </p>
<p>This version returns only the 1st derivative. </p>

<p>References <a class="el" href="em_8c.html#a638346b09068d817fcb23ebc995291a5">get_w()</a>, <a class="el" href="struct_dsq_data.html#adcf855e9e80223d33131cb0e2b44c53e">DsqData::nGam</a>, <a class="el" href="struct_dsq_data.html#a996906c461f0ce756ae25e72fd889be2">DsqData::nUnphased</a>, <a class="el" href="struct_dsq_data.html#a8bae4af34213c754abcef73f595e3e4a">DsqData::px</a>, and <a class="el" href="struct_dsq_data.html#aa3f221eac7bb1919a62b2f8b5489c3a4">DsqData::py</a>.</p>

<p>Referenced by <a class="el" href="em_8h.html#a87c044fe7efd7a666e878823e35eeae2">minimize1D()</a>.</p>

</div>
</div>
<a class="anchor" id="aff767b1a15cee1790a925391115f111f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void negLnL_df12 </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ddf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Negative of log Likelihood of given value of D. </p>
<p>This version calculates the 1st derivative (placed in *df), and the 2nd derivative (in ddf). </p>

<p>References <a class="el" href="em_8c.html#a638346b09068d817fcb23ebc995291a5">get_w()</a>, <a class="el" href="struct_dsq_data.html#adcf855e9e80223d33131cb0e2b44c53e">DsqData::nGam</a>, <a class="el" href="struct_dsq_data.html#a996906c461f0ce756ae25e72fd889be2">DsqData::nUnphased</a>, <a class="el" href="struct_dsq_data.html#a8bae4af34213c754abcef73f595e3e4a">DsqData::px</a>, and <a class="el" href="struct_dsq_data.html#aa3f221eac7bb1919a62b2f8b5489c3a4">DsqData::py</a>.</p>

<p>Referenced by <a class="el" href="em_8h.html#a87c044fe7efd7a666e878823e35eeae2">minimize1D()</a>.</p>

</div>
</div>
<a class="anchor" id="a29b4d31a97204bcb067c077c1b16dd3a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void negLnL_fddf </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>ddf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Negative of log Likelihood of given value of D. </p>
<p>This version calculates, the function value (placed in *f), its 1st derivative (placed in *df), and its 2nd derivative (in ddf). </p>

<p>References <a class="el" href="em_8c.html#a638346b09068d817fcb23ebc995291a5">get_w()</a>, <a class="el" href="struct_dsq_data.html#adcf855e9e80223d33131cb0e2b44c53e">DsqData::nGam</a>, <a class="el" href="struct_dsq_data.html#a996906c461f0ce756ae25e72fd889be2">DsqData::nUnphased</a>, <a class="el" href="struct_dsq_data.html#a8bae4af34213c754abcef73f595e3e4a">DsqData::px</a>, and <a class="el" href="struct_dsq_data.html#aa3f221eac7bb1919a62b2f8b5489c3a4">DsqData::py</a>.</p>

</div>
</div>
<a class="anchor" id="a763cb7889838068344aefd1eb170e94a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void negLnL_fdf </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>df</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Negative of log Likelihood of given value of D. </p>
<p>This version calculates both the function value (placed in *f) and its derivative (placed in *df). </p>

<p>References <a class="el" href="em_8c.html#a638346b09068d817fcb23ebc995291a5">get_w()</a>, <a class="el" href="struct_dsq_data.html#adcf855e9e80223d33131cb0e2b44c53e">DsqData::nGam</a>, <a class="el" href="struct_dsq_data.html#a996906c461f0ce756ae25e72fd889be2">DsqData::nUnphased</a>, <a class="el" href="struct_dsq_data.html#a8bae4af34213c754abcef73f595e3e4a">DsqData::px</a>, and <a class="el" href="struct_dsq_data.html#aa3f221eac7bb1919a62b2f8b5489c3a4">DsqData::py</a>.</p>

</div>
</div>
<a class="anchor" id="adb1dfc954ce3aba4150aba1ca6dbeedc"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static double next_w </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_dsq_data.html">DsqData</a> *&#160;</td>
          <td class="paramname"><em>dd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>One step of EM algorithm. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">w</td><td>Current guess as to fraction of unphased double-heterozygotes with two-locus genotype 11/00 rather than 10/01.</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dd</td><td>pointer to object of type <a class="el" href="struct_dsq_data.html" title="Data used by EM algorithm in estimating Dsq from partially phased diploid data. ">DsqData</a></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>improved estimate of w </dd></dl>

<p>References <a class="el" href="em_8c.html#a638346b09068d817fcb23ebc995291a5">get_w()</a>, and <a class="el" href="em_8c.html#aff0275c84deb2d4b7de0f4748eec1256">getD()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 29 2014 12:10:42 for ldpsiz by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
