<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ldpsiz: hayes.c File Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ldpsiz
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">LDPSIZ is a system of programs written in C and Python, which uses linkage disequilibrium to estimate parameters describing the history of population size.</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">hayes.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Code for Sved's (1971) formula, as used by Hayes et al. 2003. Genome Research 13:635-643.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="pophist_8h_source.html">pophist.h</a>&quot;</code><br/>
<code>#include &quot;hayes.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="misc_8h_source.html">misc.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="model_8h_source.html">model.h</a>&quot;</code><br/>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="hayes_8c.html#a7a49475cdda4637f7e3c847c910261ee">svedRsq</a> (double c, double twoN, int twoNsmp)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sved's (1971; also 2009, p 184) formula for E[r^2], modified to account for sampling bias as suggested by Hudson (1985, Eqn 6, p 624).  <a href="#a7a49475cdda4637f7e3c847c910261ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5821ee8bba185d5eb955b737e51f369f"></a><!-- doxytag: member="hayes.c::Hayes_rsq_dummy" ref="a5821ee8bba185d5eb955b737e51f369f" args="(double *y, int twoNsmp)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><b>Hayes_rsq_dummy</b> (double *y, int twoNsmp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac30ff4028fd91ebfc446dc1bc3e2f5f9"></a><!-- doxytag: member="hayes.c::Hayes_rsqEq_dummy" ref="ac30ff4028fd91ebfc446dc1bc3e2f5f9" args="(double *x, double twoN, double c, double u)" -->
int&#160;</td><td class="memItemRight" valign="bottom"><b>Hayes_rsqEq_dummy</b> (double *x, double twoN, double c, double u)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4752e527716f979ec092f41db72d1f64"></a><!-- doxytag: member="hayes.c::Model_allocHayes" ref="a4752e527716f979ec092f41db72d1f64" args="(int twoNsmp)" -->
<a class="el" href="struct_model.html">Model</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>Model_allocHayes</b> (int twoNsmp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a13b5a42433596ed5e8236a66d862e4de"></a><!-- doxytag: member="hayes.c::Hayes_rsqNoODE" ref="a13b5a42433596ed5e8236a66d862e4de" args="(double c, double u, PopHist *ph, int twoNsmp, void *notused)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><b>Hayes_rsqNoODE</b> (double c, double u, <a class="el" href="struct_pop_hist.html">PopHist</a> *ph, int twoNsmp, void *notused)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a120601a77d8b54c60ed23bf42372c836"></a><!-- doxytag: member="hayes.c::Hayes_rsq" ref="a120601a77d8b54c60ed23bf42372c836" args="(ODE *notused, double c, double u, PopHist *ph, int twoNsmp)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><b>Hayes_rsq</b> (<a class="el" href="struct_o_d_e.html">ODE</a> *notused, double c, double u, <a class="el" href="struct_pop_hist.html">PopHist</a> *ph, int twoNsmp)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a62f1df60ce281c9355fa2ec1b1e310e5"></a><!-- doxytag: member="hayes.c::Hayes_rsqEq" ref="a62f1df60ce281c9355fa2ec1b1e310e5" args="(double c, double u, PopHist *ph, unsigned whichEpoch, int twoNsmp, void *notused)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><b>Hayes_rsqEq</b> (double c, double u, <a class="el" href="struct_pop_hist.html">PopHist</a> *ph, unsigned whichEpoch, int twoNsmp, void *notused)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a705d07841ecd8b443c64daa3fa8bc86a"></a><!-- doxytag: member="hayes.c::Hayes_stateDim" ref="a705d07841ecd8b443c64daa3fa8bc86a" args="(void)" -->
size_t&#160;</td><td class="memItemRight" valign="bottom"><b>Hayes_stateDim</b> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a52a2abdada82d49ea8ed15f15b7a005d"></a><!-- doxytag: member="hayes.c::Hayes_stateLbl" ref="a52a2abdada82d49ea8ed15f15b7a005d" args="(unsigned notused)" -->
const char *&#160;</td><td class="memItemRight" valign="bottom"><b>Hayes_stateLbl</b> (unsigned notused)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ada0bb371644f0d43abee1ee0e67bd4ed"></a><!-- doxytag: member="hayes.c::HayesData_new" ref="ada0bb371644f0d43abee1ee0e67bd4ed" args="(void)" -->
void *&#160;</td><td class="memItemRight" valign="bottom"><b>HayesData_new</b> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae09bde60c06cbe4946ff1613f79b2cbc"></a><!-- doxytag: member="hayes.c::HayesData_stateVal" ref="ae09bde60c06cbe4946ff1613f79b2cbc" args="(void *notused, unsigned i)" -->
double&#160;</td><td class="memItemRight" valign="bottom"><b>HayesData_stateVal</b> (void *notused, unsigned i)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af052f045f79b20c7e448b7f930bd53fc"></a><!-- doxytag: member="hayes.c::HayesData_free" ref="af052f045f79b20c7e448b7f930bd53fc" args="(void *notused)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><b>HayesData_free</b> (void *notused)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>Code for Sved's (1971) formula, as used by Hayes et al. 2003. Genome Research 13:635-643. </p>
<dl class="author"><dt><b>Author:</b></dt><dd>Alan R. Rogers </dd></dl>
</div><hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7a49475cdda4637f7e3c847c910261ee"></a><!-- doxytag: member="hayes.c::svedRsq" ref="a7a49475cdda4637f7e3c847c910261ee" args="(double c, double twoN, int twoNsmp)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static double <a class="el" href="hayes_8c.html#a7a49475cdda4637f7e3c847c910261ee">svedRsq</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>twoN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>twoNsmp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sved's (1971; also 2009, p 184) formula for E[r^2], modified to account for sampling bias as suggested by Hudson (1985, Eqn 6, p 624). </p>
<p>Hudson uses "n" throughout his paper without clearly defining it. On p 631, he says that "with probability 1/n the same gamete
 will be drawn from the sample twice" (in random sampling with replacement). Thus, Hudson's "n" is the number of gametes in the sample, which equals twoNsmp in the notation below.</p>
<p>The HAYES_MUTATION_ADJUSTMENT is based on Tenesa et al (2007, Genome Research, 17(4):520-526). On p 521, these authors say:</p>
<p>For autosomal loci, Hill (1975, Theor. Pop. Biol. 8(2):117-126) showed that, in the presence of mutation, $E(r^2) = (10+)/(22 + 13 + ^2)$, with $ = 4N_e c$. Since $(22 + 13 + ^2)$ factors into $(11+)(2+)$, a further approximation is $E(r^2) = 1/(2 + ) = 1/(2 + 4N_e c)$.</p>
<p>Hill's formula (on his p 124), however, is for sigma_d^2 rather than E[r^2], so this adjustment is relevant only to the extent that sigma_d^2 approximates the expectation of r^2. Tenesa's approximation also takes 10 as approximately equal to 11--a fairly crude standard of approximation. </p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Wed May 28 2014 13:55:07 for ldpsiz by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
