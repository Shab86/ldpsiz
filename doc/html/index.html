<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>ldpsiz: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ldpsiz
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">LDPSIZ is a system of programs written in C and Python, which uses linkage disequilibrium to estimate parameters describing the history of population size.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">ldpsiz Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Introduction</h1>
<p>Ldpsiz is a computer package that estimates the history of population size from data on linkage disequilibrium (LD).</p>
<p>LD is estimated in terms of the "standard linkage deviation", <img class="formulaInl" alt="$\sigma_d^2$" src="form_2.png"/> (Ohta and Kimura, 1971, Genetics 68: 571-580). This parameter is usually interpreted as an approximation to the expected value of <img class="formulaInl" alt="$r^2$" src="form_1.png"/>, the squared correlation between loci. <img class="formulaInl" alt="$\sigma_d^2$" src="form_2.png"/> is a weighted average of <img class="formulaInl" alt="$r^2$" src="form_1.png"/> values, where the weight given each pair of loci is the product of the two heterozygosities. Because of these weights, <img class="formulaInl" alt="$\sigma_d^2$" src="form_2.png"/> is not affected much by loci near fixation. For this reason, it is ideal for use with low-coverage sequence data. Most of the sequencing errors in such data show up as singleton loci, which have little effect on <img class="formulaInl" alt="$\sigma_d^2$" src="form_2.png"/>.</p>
<p>To estimate population history parameters, <code>ldpsiz</code> minimizes the difference between values of <img class="formulaInl" alt="$\sigma_d^2$" src="form_2.png"/> estimated from data and values predicted from population history. The predicted values are obtained from the recurrence equations either of Hill (1975, Theoretical Population Biology 8:117-126) or of Strobeck and Morgan (1978, Genetics 88:829-844). This calculation can be done in two different ways. The slow way (invoked using the <code>--exact</code> option of <a class="el" href="preld_8c.html#preld">preld</a>) iterates the difference equations one generation at a time. The default method speeds things up by solving differential equations that approximate the difference equations. These methods are fast enough to allow one to examine a large number of hypotheses about history parameters.</p>
<p>To model population history, <code>ldpsiz</code> divides the past into a fixed number of epochs. Within each epoch, the population is assumed constant in size. There is no provision for multiple populations in the current version of the code. In the earliest epoch, the population is assumed to be at equilibrium with respect to genetic drift, mutation, and recombination.</p>
<p>Uncertainties are estimated using a moving-blocks bootstrap. In calculating <img class="formulaInl" alt="$\sigma_d^2$" src="form_2.png"/>, most operations are done only once for each pair of sites and are not repeated for each bootstrap replicate. Furthermore, calculations are parallelized. These provisions make it possible to use hundreds of bootstrap replicates in genome-scale analyses, on computers with large numbers of CPU cores.</p>
<h1>Installation and testing</h1>
<p>The package is available at <a href="github.com/alanrogers/ldpsiz">github</a> in various formats. Before compiling, you must install two libraries: <code>pthreads</code> and <a href="http://www.gnu.org/software/gsl">`gsl`</a>. You will need not only the libraries themselves but also several header files, such as <code>pthread.h</code>. I didn't need to install <code>pthreads</code>, because it came bundled with the Gnu C compiler. But the gsl was an extra. Under ubuntu Linux, you can install it like this: </p><pre class="fragment">sudo apt-get install libgsl0-dev
</pre><p>On the mac, using homebrew, the command is </p><pre class="fragment">brew install gsl
</pre><p>By default, the executable files will be copied into a directory named <code>bin</code> in your home directory. If you want them to go somewhere else, edit the first non-comment line of src/Makefile.</p>
<p>Then</p>
<ol type="1">
<li>Cd into the src directory.</li>
<li>Type "make".</li>
<li>Type "make install".</li>
</ol>
<p>This will try to place the executables into directory "bin" in the user's home directory. Make sure this directory appears in your PATH, so that the shell can find it.</p>
<p>This installation will work under unix-like operating systems, such as linux and Apple's osx. I haven't tried to port this software to Windows.</p>
<p>The directory <code>test</code> contains a unit test for many of the .c files in directory <code>src</code>. Within this directory, type</p>
<ol type="1">
<li>make xhill</li>
<li>./xhill</li>
</ol>
<p>to test the source file <code><a class="el" href="hill_8c.html" title="Method of Hill, William G. 1975. TPB 8:117-126. ">hill.c</a></code>. To run all unit tests, type "make". This will take awhile, as some of the unit tests are slow.</p>
<p>The unit tests will not compile if <code>NDEBUG</code> is defined. If optimization is turned on during optimization, some of the unit tests may be removed by the optimizer. To avoid these problems, comment out the relevant line at the top of src/Makefile.</p>
<h1>Genetic input data</h1>
<p><code>ldpsiz</code> reads data files in "gtp" format. In the distribution, the names of all such files end with the suffix ".gtp". Here are the first few lines of a sample .gtp file containing haploid data: </p><pre class="fragment"># data source           = /Users/rogers/bin/macs2gtp.py out
# time                  = 2012-05-28 09:28:11.098762
# ploidy                = 1
#   snp_id     nucpos   mappos alleles genotypes
         0        262   0.0262      AG 0001000000
         1        362   0.0362      AT 0000010000
         2        536   0.0536      TC 1000000000
         3        799   0.0799      TA 0010000000
         4        861   0.0861      CT 0000000100
</pre><p>The first 3 lines are optional, but the line of column headers is not. After the header (the lines beginning with '#'), each line refers to a single-nucleotide polymorphism (a <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a>). The columns are as follows:</p>
<ol type="1">
<li>snp_id is an arbitrary label associated with the <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a>. These labels are not used.</li>
<li>nucpos The position of the <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a> on the chromosome, measured in nucleotides.</li>
<li>mappos The position of the <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a> on the chromosome, measured in centimorgans (cM).</li>
<li>The alleles present at this <a class="el" href="struct_s_n_p.html" title="Estimate the linkage disequilibrium (LD) between single nucleotide polymorphisms (SNPs) as a function...">SNP</a> locus (for example, AC or 01).</li>
<li>The state of each individual in the sample. State is always either 0 or 1. A "1" indicates that the allele at this position was the first allele in the list of alleles. A "0" indicates any of the alternate alleles. For example, if the alleles list was "AT", then genotypes "0110" mean "TAAT". There is no provision for missing values.</li>
</ol>
<p>For diploid data, the header must contain the line </p><pre class="fragment"># ploidy                = 2
</pre><p>For diploid data, each phased genotype is a <em>pair</em> of adjacent character values. Homozygotes look like "00" or "11", and phased heterozygotes look like "01" or "10". Unphased heterozygotes look like "h" and occupy just a single character position.</p>
<h1>Initialization file</h1>
<p>Many of the programs read an initialization file called <code>ldpsiz.ini</code>, which can be used to set various parameters and to specify a population history. This makes it easy to use a single set of parameters in a variety of operations, involving different programs within the package.</p>
<p>Here is an example initialization file: </p><pre class="fragment"># Comments go from "#" to end of line.
blocksize       = 300  # SNPs per block in bootstrap
bootfilename    = eld.boot
bootreps        = 25   # number of bootstrap replicates
recombination   = 2e-7 # per site per generation
mutation        = 1e-7 # per site per generation
confidence      = 0.8  # size of confidence interval
windowCm        = 0.1  # maximum difference (cM) btw SNPs compared
loCm            = 0.0  # lowest recombination rate in centimorgans
hiCm            = 0.3  # highest
methods         = Hill # models of evolution; comma-separated
nbins           = 25   # number of bins, each referring to a 
                       # narrow range of recombination rates
nthreads        = 3    # number of threads
twoNsmp         = 30   # number of gene copies in sample

# Population history must come last in the file. In begins 
# with a line containing the single word "PopHist".
# Each row defines an epoch of population history. The first row
# refers to the most recent epoch.
# Column 1: length of epoch in generations
# Column 2: haploid population size, 2N
PopHist
# generations twoN
           40  1e5   # epoch 0
          Inf  1e2   # epoch 1
</pre><p>Parameters specified in <code>ldpsiz.ini</code> can be overridden by command-line arguments. Default values are provided for parameters not specified in either of these ways.</p>
<h1>Usage</h1>
<p>The <code>ldpsiz</code> package is not a single monolithic program, but rather a suite of programs. These programs are designed to be run at the command line: there is no graphical user interface. Each program will print a usage message in response to the command-line argument <code>--help</code> or <code>-h</code>. The various programs are described briefly below. For more detail, see the documentation for each individual program.</p>
<h2>Converting genetic data into .gtp format</h2>
<p>The package provides several programs for converting into .gtp format. <code>ms2gtp</code> and <code><a class="el" href="macs2gtp_8py.html" title="Parse output of macs, produce gtp format, the input for eld. ">macs2gtp.py</a></code> convert simulated data produced by <code>ms</code> and <code>macs</code>, and <code><a class="el" href="vcf2gtp_8py.html" title="Convert .vcf files into .gtp format. ">vcf2gtp.py</a></code> converts the vcf-format data provided by the 1000 Genomes Project. These programs are written in Python, except for <code>ms2gtp</code>, which is in C.</p>
<h3>Converting data produced by <code>ms</code></h3>
<p><code>ms</code> is Dick Hudson's program for doing coalescent simulations with recombination. It can be downloaded from Dick's <a href="http://home.uchicago.edu/rhudson1/source.html">homepage</a>. The <code>ldpsiz</code> package provides a program, <a class="el" href="ms2gtp_8c.html#ms2gtp">ms2gtp</a>, which converts the output of <code>ms</code> into .gtp format.</p>
<p>This program is written in C, because it involves transposing a large matrix. The original version, written in Python, was slow.</p>
<h3>Converting data produced by <code>macs</code></h3>
<p>Gary Chen's program, <code>macs</code>, uses an approximation to the coalescent algorithm, which makes it possible to simulate genome-scale data very fast. You can get it from Gary's <a href="http://www-hsc.usc.edu/~garykche">homepage</a>. To translate <code>macs</code> output into .gtp format, use the program <a class="el" href="macs2gtp_8py.html">macs2gtp</a>.</p>
<h3>Converting data from the 1000-Genomes Project</h3>
<p>To convert data files from the 1000-Genomes Project, use the program <a class="el" href="vcf2gtp_8py.html">vcf2gtp</a>.</p>
<h2>Predicting <img class="formulaInl" alt="$\sigma_d^2$" src="form_2.png"/> from population history</h2>
<p>See the documentation for <a class="el" href="preld_8c.html#preld">preld</a>.</p>
<h2>Estimating <img class="formulaInl" alt="$\sigma_d^2$" src="form_2.png"/></h2>
<p>See the documentation for <a class="el" href="eld_8c.html#eld">eld</a>.</p>
<h2>Estimating parameters of population history</h2>
<p>See the documentation for <a class="el" href="sald_8c.html#sald">sald</a>.</p>
<h2>Examining the cost function.</h2>
<p>See the documentation for <a class="el" href="mcmcld_8c.html#mcmcld">mcmcld</a>. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu May 29 2014 12:10:42 for ldpsiz by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
